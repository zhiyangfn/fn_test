
//#include <stdio.h> 
//#include <math.h>
#include "libzfft_int.h"


#define int64_t long
#if (N==64)           
#define N_64       
#define DIV_ME 150     
#endif
#if (N==128)      
#define N_128 
#define DIV_ME  180           
#endif
#if (N==256)           
#define N_256     
#define DIV_ME  200       
#endif
#if (N==512)           
#define N_512   
#define DIV_ME  250         
#endif
#if (N==1024)           
#define N_1024    
#define DIV_ME  350        
#endif
#if (N==2048)           
#define N_2048       
#define DIV_ME  550     
#endif



#define INT32_MAX 2147483647
#define INT32_MIN (-2147483647 - 1)
#define FA_FIXMUL_32X15(a,b)  ((int)(((int64_t)(a) *(int64_t)(b))>>(15)))


/*
static inline float fa_roundf(float x)
{
    return (x > 0) ? floor(x + 0.5) : ceil(x - 0.5);
}
#define FA_SCALE_FLOAT(a, bits)     fa_rintf((a) * (float)(1 << (bits)))
static int fa_clip_int(int a, int amin, int amax)
{
    if      (a < amin) return amin;
    else if (a > amax) return amax;
    else               return a;
}
static inline int fa_rintf(float x)
{
    float xx;

    xx = fa_roundf(x);

    if     (xx > INT32_MAX) return INT32_MAX;
    else if(xx < INT32_MIN) return INT32_MIN;
    else                    return (int)xx;
}
#define FA_FIX15(a)                 fa_clip_int(FA_SCALE_FLOAT(a, 15), -32767, 32767)
*/

static int base;
static int bit_rvs[N];
static int fft_work[N*2];

#ifdef N_2048
const int hanningTab[N]={ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 6, 6, 6, 6, 7, 7, 7, 7, 8, 8, 8, 8, 9, 9, 9, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 13, 13, 14, 14, 14, 15, 15, 15, 16, 16, 17, 17, 17, 18, 18, 19, 19, 19, 20, 20, 21, 21, 22, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 30, 30, 31, 31, 32, 32, 33, 34, 34, 35, 35, 36, 36, 37, 38, 38, 39, 39, 40, 40, 41, 42, 42, 43, 44, 44, 45, 45, 46, 47, 47, 48, 49, 49, 50, 51, 51, 52, 53, 53, 54, 55, 56, 56, 57, 58, 58, 59, 60, 61, 61, 62, 63, 64, 64, 65, 66, 67, 67, 68, 69, 70, 70, 71, 72, 73, 74, 74, 75, 76, 77, 78, 78, 79, 80, 81, 82, 83, 83, 84, 85, 86, 87, 88, 89, 90, 90, 91, 92, 93, 94, 95, 96, 97, 98, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 158, 159, 160, 161, 162, 163, 164, 166, 167, 168, 169, 170, 171, 172, 174, 175, 176, 177, 178, 179, 181, 182, 183, 184, 185, 187, 188, 189, 190, 191, 193, 194, 195, 196, 197, 199, 200, 201, 202, 204, 205, 206, 207, 209, 210, 211, 212, 214, 215, 216, 217, 219, 220, 221, 222, 224, 225, 226, 228, 229, 230, 231, 233, 234, 235, 237, 238, 239, 241, 242, 243, 244, 246, 247, 248, 250, 251, 252, 254, 255, 256, 258, 259, 260, 262, 263, 265, 266, 267, 269, 270, 271, 273, 274, 275, 277, 278, 280, 281, 282, 284, 285, 286, 288, 289, 291, 292, 293, 295, 296, 298, 299, 300, 302, 303, 305, 306, 308, 309, 310, 312, 313, 315, 316, 317, 319, 320, 322, 323, 325, 326, 328, 329, 330, 332, 333, 335, 336, 338, 339, 341, 342, 343, 345, 346, 348, 349, 351, 352, 354, 355, 357, 358, 360, 361, 363, 364, 365, 367, 368, 370, 371, 373, 374, 376, 377, 379, 380, 382, 383, 385, 386, 388, 389, 391, 392, 394, 395, 397, 398, 400, 401, 403, 404, 406, 407, 409, 410, 412, 413, 415, 416, 418, 419, 421, 422, 424, 425, 427, 428, 430, 432, 433, 435, 436, 438, 439, 441, 442, 444, 445, 447, 448, 450, 451, 453, 454, 456, 457, 459, 461, 462, 464, 465, 467, 468, 470, 471, 473, 474, 476, 477, 479, 480, 482, 484, 485, 487, 488, 490, 491, 493, 494, 496, 497, 499, 500, 502, 503, 505, 507, 508, 510, 511, 513, 514, 516, 517, 519, 520, 522, 523, 525, 526, 528, 530, 531, 533, 534, 536, 537, 539, 540, 542, 543, 545, 546, 548, 549, 551, 552, 554, 556, 557, 559, 560, 562, 563, 565, 566, 568, 569, 571, 572, 574, 575, 577, 578, 580, 581, 583, 584, 586, 587, 589, 590, 592, 593, 595, 596, 598, 599, 601, 602, 604, 605, 607, 608, 610, 611, 613, 614, 616, 617, 619, 620, 622, 623, 625, 626, 628, 629, 631, 632, 634, 635, 637, 638, 640, 641, 643, 644, 646, 647, 649, 650, 651, 653, 654, 656, 657, 659, 660, 662, 663, 665, 666, 667, 669, 670, 672, 673, 675, 676, 678, 679, 680, 682, 683, 685, 686, 688, 689, 690, 692, 693, 695, 696, 697, 699, 700, 702, 703, 704, 706, 707, 709, 710, 711, 713, 714, 716, 717, 718, 720, 721, 723, 724, 725, 727, 728, 729, 731, 732, 733, 735, 736, 737, 739, 740, 742, 743, 744, 746, 747, 748, 750, 751, 752, 754, 755, 756, 757, 759, 760, 761, 763, 764, 765, 767, 768, 769, 771, 772, 773, 774, 776, 777, 778, 779, 781, 782, 783, 785, 786, 787, 788, 790, 791, 792, 793, 795, 796, 797, 798, 800, 801, 802, 803, 804, 806, 807, 808, 809, 810, 812, 813, 814, 815, 816, 818, 819, 820, 821, 822, 824, 825, 826, 827, 828, 829, 830, 832, 833, 834, 835, 836, 837, 838, 840, 841, 842, 843, 844, 845, 846, 847, 848, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 863, 864, 865, 866, 867, 868, 869, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 881, 882, 883, 884, 885, 886, 887, 888, 889, 890, 891, 892, 893, 894, 895, 895, 896, 897, 898, 899, 900, 901, 902, 903, 904, 905, 906, 906, 907, 908, 909, 910, 911, 912, 913, 914, 914, 915, 916, 917, 918, 919, 919, 920, 921, 922, 923, 924, 924, 925, 926, 927, 928, 928, 929, 930, 931, 932, 932, 933, 934, 935, 935, 936, 937, 938, 938, 939, 940, 941, 941, 942, 943, 943, 944, 945, 946, 946, 947, 948, 948, 949, 950, 950, 951, 952, 952, 953, 954, 954, 955, 955, 956, 957, 957, 958, 959, 959, 960, 960, 961, 962, 962, 963, 963, 964, 965, 965, 966, 966, 967, 967, 968, 968, 969, 969, 970, 970, 971, 972, 972, 973, 973, 974, 974, 974, 975, 975, 976, 976, 977, 977, 978, 978, 979, 979, 980, 980, 980, 981, 981, 982, 982, 982, 983, 983, 984, 984, 984, 985, 985, 986, 986, 986, 987, 987, 987, 988, 988, 988, 989, 989, 989, 990, 990, 990, 991, 991, 991, 991, 992, 992, 992, 992, 993, 993, 993, 994, 994, 994, 994, 994, 995, 995, 995, 995, 996, 996, 996, 996, 996, 997, 997, 997, 997, 997, 997, 998, 998, 998, 998, 998, 998, 998, 998, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 998, 998, 998, 998, 998, 998, 998, 998, 997, 997, 997, 997, 997, 997, 996, 996, 996, 996, 996, 995, 995, 995, 995, 994, 994, 994, 994, 994, 993, 993, 993, 992, 992, 992, 992, 991, 991, 991, 991, 990, 990, 990, 989, 989, 989, 988, 988, 988, 987, 987, 987, 986, 986, 986, 985, 985, 984, 984, 984, 983, 983, 982, 982, 982, 981, 981, 980, 980, 980, 979, 979, 978, 978, 977, 977, 976, 976, 975, 975, 974, 974, 974, 973, 973, 972, 972, 971, 970, 970, 969, 969, 968, 968, 967, 967, 966, 966, 965, 965, 964, 963, 963, 962, 962, 961, 960, 960, 959, 959, 958, 957, 957, 956, 955, 955, 954, 954, 953, 952, 952, 951, 950, 950, 949, 948, 948, 947, 946, 946, 945, 944, 943, 943, 942, 941, 941, 940, 939, 938, 938, 937, 936, 935, 935, 934, 933, 932, 932, 931, 930, 929, 928, 928, 927, 926, 925, 924, 924, 923, 922, 921, 920, 919, 919, 918, 917, 916, 915, 914, 914, 913, 912, 911, 910, 909, 908, 907, 906, 906, 905, 904, 903, 902, 901, 900, 899, 898, 897, 896, 895, 895, 894, 893, 892, 891, 890, 889, 888, 887, 886, 885, 884, 883, 882, 881, 880, 879, 878, 877, 876, 875, 874, 873, 872, 871, 870, 869, 868, 867, 866, 865, 864, 863, 861, 860, 859, 858, 857, 856, 855, 854, 853, 852, 851, 850, 848, 847, 846, 845, 844, 843, 842, 841, 840, 838, 837, 836, 835, 834, 833, 832, 830, 829, 828, 827, 826, 825, 824, 822, 821, 820, 819, 818, 816, 815, 814, 813, 812, 810, 809, 808, 807, 806, 804, 803, 802, 801, 800, 798, 797, 796, 795, 793, 792, 791, 790, 788, 787, 786, 785, 783, 782, 781, 779, 778, 777, 776, 774, 773, 772, 771, 769, 768, 767, 765, 764, 763, 761, 760, 759, 757, 756, 755, 754, 752, 751, 750, 748, 747, 746, 744, 743, 742, 740, 739, 737, 736, 735, 733, 732, 731, 729, 728, 727, 725, 724, 723, 721, 720, 718, 717, 716, 714, 713, 711, 710, 709, 707, 706, 704, 703, 702, 700, 699, 697, 696, 695, 693, 692, 690, 689, 688, 686, 685, 683, 682, 680, 679, 678, 676, 675, 673, 672, 670, 669, 667, 666, 665, 663, 662, 660, 659, 657, 656, 654, 653, 651, 650, 649, 647, 646, 644, 643, 641, 640, 638, 637, 635, 634, 632, 631, 629, 628, 626, 625, 623, 622, 620, 619, 617, 616, 614, 613, 611, 610, 608, 607, 605, 604, 602, 601, 599, 598, 596, 595, 593, 592, 590, 589, 587, 586, 584, 583, 581, 580, 578, 577, 575, 574, 572, 571, 569, 568, 566, 565, 563, 562, 560, 559, 557, 556, 554, 552, 551, 549, 548, 546, 545, 543, 542, 540, 539, 537, 536, 534, 533, 531, 530, 528, 526, 525, 523, 522, 520, 519, 517, 516, 514, 513, 511, 510, 508, 507, 505, 503, 502, 500, 499, 497, 496, 494, 493, 491, 490, 488, 487, 485, 484, 482, 480, 479, 477, 476, 474, 473, 471, 470, 468, 467, 465, 464, 462, 461, 459, 457, 456, 454, 453, 451, 450, 448, 447, 445, 444, 442, 441, 439, 438, 436, 435, 433, 432, 430, 428, 427, 425, 424, 422, 421, 419, 418, 416, 415, 413, 412, 410, 409, 407, 406, 404, 403, 401, 400, 398, 397, 395, 394, 392, 391, 389, 388, 386, 385, 383, 382, 380, 379, 377, 376, 374, 373, 371, 370, 368, 367, 365, 364, 363, 361, 360, 358, 357, 355, 354, 352, 351, 349, 348, 346, 345, 343, 342, 341, 339, 338, 336, 335, 333, 332, 330, 329, 328, 326, 325, 323, 322, 320, 319, 317, 316, 315, 313, 312, 310, 309, 308, 306, 305, 303, 302, 300, 299, 298, 296, 295, 293, 292, 291, 289, 288, 286, 285, 284, 282, 281, 280, 278, 277, 275, 274, 273, 271, 270, 269, 267, 266, 265, 263, 262, 260, 259, 258, 256, 255, 254, 252, 251, 250, 248, 247, 246, 244, 243, 242, 241, 239, 238, 237, 235, 234, 233, 231, 230, 229, 228, 226, 225, 224, 222, 221, 220, 219, 217, 216, 215, 214, 212, 211, 210, 209, 207, 206, 205, 204, 202, 201, 200, 199, 197, 196, 195, 194, 193, 191, 190, 189, 188, 187, 185, 184, 183, 182, 181, 179, 178, 177, 176, 175, 174, 172, 171, 170, 169, 168, 167, 166, 164, 163, 162, 161, 160, 159, 158, 156, 155, 154, 153, 152, 151, 150, 149, 148, 147, 145, 144, 143, 142, 141, 140, 139, 138, 137, 136, 135, 134, 133, 132, 131, 130, 129, 128, 127, 126, 125, 124, 123, 122, 121, 120, 119, 118, 117, 116, 115, 114, 113, 112, 111, 110, 109, 108, 107, 106, 105, 104, 103, 102, 101, 100, 99, 98, 98, 97, 96, 95, 94, 93, 92, 91, 90, 90, 89, 88, 87, 86, 85, 84, 83, 83, 82, 81, 80, 79, 78, 78, 77, 76, 75, 74, 74, 73, 72, 71, 70, 70, 69, 68, 67, 67, 66, 65, 64, 64, 63, 62, 61, 61, 60, 59, 58, 58, 57, 56, 56, 55, 54, 53, 53, 52, 51, 51, 50, 49, 49, 48, 47, 47, 46, 45, 45, 44, 44, 43, 42, 42, 41, 40, 40, 39, 39, 38, 38, 37, 36, 36, 35, 35, 34, 34, 33, 32, 32, 31, 31, 30, 30, 29, 29, 28, 28, 27, 27, 26, 26, 25, 25, 24, 24, 23, 23, 22, 22, 22, 21, 21, 20, 20, 19, 19, 19, 18, 18, 17, 17, 17, 16, 16, 15, 15, 15, 14, 14, 14, 13, 13, 12, 12, 12, 11, 11, 11, 11, 10, 10, 10, 9, 9, 9, 8, 8, 8, 8, 7, 7, 7, 7, 6, 6, 6, 6, 5, 5, 5, 5, 5, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
const short cos_ang[N] = { 32767, 32767, 32767, 32767, 32766, 32764, 32762, 32760, 32758, 32756, 32753, 32749, 32746, 32742, 32738, 32733, 32729, 32723, 32718, 32712, 32706, 32700, 32693, 32686, 32679, 32672, 32664, 32656, 32647, 32638, 32629, 32620, 32610, 32600, 32590, 32579, 32568, 32557, 32546, 32534, 32522, 32509, 32496, 32483, 32470, 32456, 32442, 32428, 32413, 32398, 32383, 32368, 32352, 32336, 32319, 32303, 32286, 32268, 32251, 32233, 32214, 32196, 32177, 32158, 32138, 32119, 32099, 32078, 32058, 32037, 32015, 31994, 31972, 31950, 31927, 31904, 31881, 31858, 31834, 31810, 31786, 31761, 31737, 31711, 31686, 31660, 31634, 31608, 31581, 31554, 31527, 31499, 31471, 31443, 31415, 31386, 31357, 31328, 31298, 31268, 31238, 31207, 31177, 31146, 31114, 31082, 31050, 31018, 30986, 30953, 30920, 30886, 30853, 30819, 30784, 30750, 30715, 30680, 30644, 30608, 30572, 30536, 30499, 30462, 30425, 30388, 30350, 30312, 30274, 30235, 30196, 30157, 30118, 30078, 30038, 29997, 29957, 29916, 29875, 29833, 29792, 29750, 29707, 29665, 29622, 29579, 29535, 29492, 29448, 29404, 29359, 29314, 29269, 29224, 29178, 29132, 29086, 29040, 28993, 28946, 28899, 28851, 28803, 28755, 28707, 28658, 28610, 28560, 28511, 28461, 28411, 28361, 28311, 28260, 28209, 28158, 28106, 28054, 28002, 27950, 27897, 27844, 27791, 27738, 27684, 27630, 27576, 27522, 27467, 27412, 27357, 27301, 27246, 27190, 27133, 27077, 27020, 26963, 26906, 26848, 26791, 26733, 26674, 26616, 26557, 26498, 26439, 26379, 26320, 26259, 26199, 26139, 26078, 26017, 25956, 25894, 25833, 25771, 25708, 25646, 25583, 25520, 25457, 25394, 25330, 25266, 25202, 25138, 25073, 25008, 24943, 24878, 24812, 24746, 24680, 24614, 24548, 24481, 24414, 24347, 24279, 24212, 24144, 24076, 24008, 23939, 23870, 23801, 23732, 23663, 23593, 23523, 23453, 23383, 23312, 23241, 23170, 23099, 23028, 22956, 22884, 22812, 22740, 22668, 22595, 22522, 22449, 22375, 22302, 22228, 22154, 22080, 22006, 21931, 21856, 21781, 21706, 21631, 21555, 21479, 21403, 21327, 21251, 21174, 21097, 21020, 20943, 20865, 20788, 20710, 20632, 20554, 20475, 20397, 20318, 20239, 20160, 20081, 20001, 19921, 19841, 19761, 19681, 19601, 19520, 19439, 19358, 19277, 19195, 19114, 19032, 18950, 18868, 18786, 18703, 18621, 18538, 18455, 18372, 18288, 18205, 18121, 18037, 17953, 17869, 17785, 17700, 17616, 17531, 17446, 17361, 17275, 17190, 17104, 17018, 16932, 16846, 16760, 16673, 16587, 16500, 16413, 16326, 16239, 16151, 16064, 15976, 15888, 15800, 15712, 15624, 15535, 15447, 15358, 15269, 15180, 15091, 15002, 14912, 14823, 14733, 14643, 14553, 14463, 14373, 14282, 14192, 14101, 14010, 13919, 13828, 13737, 13646, 13554, 13463, 13371, 13279, 13187, 13095, 13003, 12910, 12818, 12725, 12633, 12540, 12447, 12354, 12261, 12167, 12074, 11980, 11887, 11793, 11699, 11605, 11511, 11417, 11323, 11228, 11134, 11039, 10945, 10850, 10755, 10660, 10565, 10469, 10374, 10279, 10183, 10088, 9992, 9896, 9800, 9704, 9608, 9512, 9416, 9319, 9223, 9127, 9030, 8933, 8836, 8740, 8643, 8546, 8449, 8351, 8254, 8157, 8059, 7962, 7864, 7767, 7669, 7571, 7473, 7376, 7278, 7180, 7081, 6983, 6885, 6787, 6688, 6590, 6491, 6393, 6294, 6195, 6097, 5998, 5899, 5800, 5701, 5602, 5503, 5404, 5305, 5205, 5106, 5007, 4907, 4808, 4709, 4609, 4510, 4410, 4310, 4211, 4111, 4011, 3911, 3812, 3712, 3612, 3512, 3412, 3312, 3212, 3112, 3012, 2912, 2811, 2711, 2611, 2511, 2411, 2310, 2210, 2110, 2009, 1909, 1809, 1708, 1608, 1507, 1407, 1307, 1206, 1106, 1005, 905, 804, 704, 603, 503, 402, 302, 201, 101, 0, -101, -201, -302, -402, -503, -603, -704, -804, -905, -1005, -1106, -1206, -1307, -1407, -1507, -1608, -1708, -1809, -1909, -2009, -2110, -2210, -2310, -2411, -2511, -2611, -2711, -2811, -2912, -3012, -3112, -3212, -3312, -3412, -3512, -3612, -3712, -3812, -3911, -4011, -4111, -4211, -4310, -4410, -4510, -4609, -4709, -4808, -4907, -5007, -5106, -5205, -5305, -5404, -5503, -5602, -5701, -5800, -5899, -5998, -6097, -6195, -6294, -6393, -6491, -6590, -6688, -6787, -6885, -6983, -7081, -7180, -7278, -7376, -7473, -7571, -7669, -7767, -7864, -7962, -8059, -8157, -8254, -8351, -8449, -8546, -8643, -8740, -8836, -8933, -9030, -9127, -9223, -9319, -9416, -9512, -9608, -9704, -9800, -9896, -9992, -10088, -10183, -10279, -10374, -10469, -10565, -10660, -10755, -10850, -10945, -11039, -11134, -11228, -11323, -11417, -11511, -11605, -11699, -11793, -11887, -11980, -12074, -12167, -12261, -12354, -12447, -12540, -12633, -12725, -12818, -12910, -13003, -13095, -13187, -13279, -13371, -13463, -13554, -13646, -13737, -13828, -13919, -14010, -14101, -14192, -14282, -14373, -14463, -14553, -14643, -14733, -14823, -14912, -15002, -15091, -15180, -15269, -15358, -15447, -15535, -15624, -15712, -15800, -15888, -15976, -16064, -16151, -16239, -16326, -16413, -16500, -16587, -16673, -16760, -16846, -16932, -17018, -17104, -17190, -17275, -17361, -17446, -17531, -17616, -17700, -17785, -17869, -17953, -18037, -18121, -18205, -18288, -18372, -18455, -18538, -18621, -18703, -18786, -18868, -18950, -19032, -19114, -19195, -19277, -19358, -19439, -19520, -19601, -19681, -19761, -19841, -19921, -20001, -20081, -20160, -20239, -20318, -20397, -20475, -20554, -20632, -20710, -20788, -20865, -20943, -21020, -21097, -21174, -21251, -21327, -21403, -21479, -21555, -21631, -21706, -21781, -21856, -21931, -22006, -22080, -22154, -22228, -22302, -22375, -22449, -22522, -22595, -22668, -22740, -22812, -22884, -22956, -23028, -23099, -23170, -23241, -23312, -23383, -23453, -23523, -23593, -23663, -23732, -23801, -23870, -23939, -24008, -24076, -24144, -24212, -24279, -24347, -24414, -24481, -24548, -24614, -24680, -24746, -24812, -24878, -24943, -25008, -25073, -25138, -25202, -25266, -25330, -25394, -25457, -25520, -25583, -25646, -25708, -25771, -25833, -25894, -25956, -26017, -26078, -26139, -26199, -26259, -26320, -26379, -26439, -26498, -26557, -26616, -26674, -26733, -26791, -26848, -26906, -26963, -27020, -27077, -27133, -27190, -27246, -27301, -27357, -27412, -27467, -27522, -27576, -27630, -27684, -27738, -27791, -27844, -27897, -27950, -28002, -28054, -28106, -28158, -28209, -28260, -28311, -28361, -28411, -28461, -28511, -28560, -28610, -28658, -28707, -28755, -28803, -28851, -28899, -28946, -28993, -29040, -29086, -29132, -29178, -29224, -29269, -29314, -29359, -29404, -29448, -29492, -29535, -29579, -29622, -29665, -29707, -29750, -29792, -29833, -29875, -29916, -29957, -29997, -30038, -30078, -30118, -30157, -30196, -30235, -30274, -30312, -30350, -30388, -30425, -30462, -30499, -30536, -30572, -30608, -30644, -30680, -30715, -30750, -30784, -30819, -30853, -30886, -30920, -30953, -30986, -31018, -31050, -31082, -31114, -31146, -31177, -31207, -31238, -31268, -31298, -31328, -31357, -31386, -31415, -31443, -31471, -31499, -31527, -31554, -31581, -31608, -31634, -31660, -31686, -31711, -31737, -31761, -31786, -31810, -31834, -31858, -31881, -31904, -31927, -31950, -31972, -31994, -32015, -32037, -32058, -32078, -32099, -32119, -32138, -32158, -32177, -32196, -32214, -32233, -32251, -32268, -32286, -32303, -32319, -32336, -32352, -32368, -32383, -32398, -32413, -32428, -32442, -32456, -32470, -32483, -32496, -32509, -32522, -32534, -32546, -32557, -32568, -32579, -32590, -32600, -32610, -32620, -32629, -32638, -32647, -32656, -32664, -32672, -32679, -32686, -32693, -32700, -32706, -32712, -32718, -32723, -32729, -32733, -32738, -32742, -32746, -32749, -32753, -32756, -32758, -32760, -32762, -32764, -32766, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32766, -32764, -32762, -32760, -32758, -32756, -32753, -32749, -32746, -32742, -32738, -32733, -32729, -32723, -32718, -32712, -32706, -32700, -32693, -32686, -32679, -32672, -32664, -32656, -32647, -32638, -32629, -32620, -32610, -32600, -32590, -32579, -32568, -32557, -32546, -32534, -32522, -32509, -32496, -32483, -32470, -32456, -32442, -32428, -32413, -32398, -32383, -32368, -32352, -32336, -32319, -32303, -32286, -32268, -32251, -32233, -32214, -32196, -32177, -32158, -32138, -32119, -32099, -32078, -32058, -32037, -32015, -31994, -31972, -31950, -31927, -31904, -31881, -31858, -31834, -31810, -31786, -31761, -31737, -31711, -31686, -31660, -31634, -31608, -31581, -31554, -31527, -31499, -31471, -31443, -31415, -31386, -31357, -31328, -31298, -31268, -31238, -31207, -31177, -31146, -31114, -31082, -31050, -31018, -30986, -30953, -30920, -30886, -30853, -30819, -30784, -30750, -30715, -30680, -30644, -30608, -30572, -30536, -30499, -30462, -30425, -30388, -30350, -30312, -30274, -30235, -30196, -30157, -30118, -30078, -30038, -29997, -29957, -29916, -29875, -29833, -29792, -29750, -29707, -29665, -29622, -29579, -29535, -29492, -29448, -29404, -29359, -29314, -29269, -29224, -29178, -29132, -29086, -29040, -28993, -28946, -28899, -28851, -28803, -28755, -28707, -28658, -28610, -28560, -28511, -28461, -28411, -28361, -28311, -28260, -28209, -28158, -28106, -28054, -28002, -27950, -27897, -27844, -27791, -27738, -27684, -27630, -27576, -27522, -27467, -27412, -27357, -27301, -27246, -27190, -27133, -27077, -27020, -26963, -26906, -26848, -26791, -26733, -26674, -26616, -26557, -26498, -26439, -26379, -26320, -26259, -26199, -26139, -26078, -26017, -25956, -25894, -25833, -25771, -25708, -25646, -25583, -25520, -25457, -25394, -25330, -25266, -25202, -25138, -25073, -25008, -24943, -24878, -24812, -24746, -24680, -24614, -24548, -24481, -24414, -24347, -24279, -24212, -24144, -24076, -24008, -23939, -23870, -23801, -23732, -23663, -23593, -23523, -23453, -23383, -23312, -23241, -23170, -23099, -23028, -22956, -22884, -22812, -22740, -22668, -22595, -22522, -22449, -22375, -22302, -22228, -22154, -22080, -22006, -21931, -21856, -21781, -21706, -21631, -21555, -21479, -21403, -21327, -21251, -21174, -21097, -21020, -20943, -20865, -20788, -20710, -20632, -20554, -20475, -20397, -20318, -20239, -20160, -20081, -20001, -19921, -19841, -19761, -19681, -19601, -19520, -19439, -19358, -19277, -19195, -19114, -19032, -18950, -18868, -18786, -18703, -18621, -18538, -18455, -18372, -18288, -18205, -18121, -18037, -17953, -17869, -17785, -17700, -17616, -17531, -17446, -17361, -17275, -17190, -17104, -17018, -16932, -16846, -16760, -16673, -16587, -16500, -16413, -16326, -16239, -16151, -16064, -15976, -15888, -15800, -15712, -15624, -15535, -15447, -15358, -15269, -15180, -15091, -15002, -14912, -14823, -14733, -14643, -14553, -14463, -14373, -14282, -14192, -14101, -14010, -13919, -13828, -13737, -13646, -13554, -13463, -13371, -13279, -13187, -13095, -13003, -12910, -12818, -12725, -12633, -12540, -12447, -12354, -12261, -12167, -12074, -11980, -11887, -11793, -11699, -11605, -11511, -11417, -11323, -11228, -11134, -11039, -10945, -10850, -10755, -10660, -10565, -10469, -10374, -10279, -10183, -10088, -9992, -9896, -9800, -9704, -9608, -9512, -9416, -9319, -9223, -9127, -9030, -8933, -8836, -8740, -8643, -8546, -8449, -8351, -8254, -8157, -8059, -7962, -7864, -7767, -7669, -7571, -7473, -7376, -7278, -7180, -7081, -6983, -6885, -6787, -6688, -6590, -6491, -6393, -6294, -6195, -6097, -5998, -5899, -5800, -5701, -5602, -5503, -5404, -5305, -5205, -5106, -5007, -4907, -4808, -4709, -4609, -4510, -4410, -4310, -4211, -4111, -4011, -3911, -3812, -3712, -3612, -3512, -3412, -3312, -3212, -3112, -3012, -2912, -2811, -2711, -2611, -2511, -2411, -2310, -2210, -2110, -2009, -1909, -1809, -1708, -1608, -1507, -1407, -1307, -1206, -1106, -1005, -905, -804, -704, -603, -503, -402, -302, -201, -101, 0, 101, 201, 302, 402, 503, 603, 704, 804, 905, 1005, 1106, 1206, 1307, 1407, 1507, 1608, 1708, 1809, 1909, 2009, 2110, 2210, 2310, 2411, 2511, 2611, 2711, 2811, 2912, 3012, 3112, 3212, 3312, 3412, 3512, 3612, 3712, 3812, 3911, 4011, 4111, 4211, 4310, 4410, 4510, 4609, 4709, 4808, 4907, 5007, 5106, 5205, 5305, 5404, 5503, 5602, 5701, 5800, 5899, 5998, 6097, 6195, 6294, 6393, 6491, 6590, 6688, 6787, 6885, 6983, 7081, 7180, 7278, 7376, 7473, 7571, 7669, 7767, 7864, 7962, 8059, 8157, 8254, 8351, 8449, 8546, 8643, 8740, 8836, 8933, 9030, 9127, 9223, 9319, 9416, 9512, 9608, 9704, 9800, 9896, 9992, 10088, 10183, 10279, 10374, 10469, 10565, 10660, 10755, 10850, 10945, 11039, 11134, 11228, 11323, 11417, 11511, 11605, 11699, 11793, 11887, 11980, 12074, 12167, 12261, 12354, 12447, 12540, 12633, 12725, 12818, 12910, 13003, 13095, 13187, 13279, 13371, 13463, 13554, 13646, 13737, 13828, 13919, 14010, 14101, 14192, 14282, 14373, 14463, 14553, 14643, 14733, 14823, 14912, 15002, 15091, 15180, 15269, 15358, 15447, 15535, 15624, 15712, 15800, 15888, 15976, 16064, 16151, 16239, 16326, 16413, 16500, 16587, 16673, 16760, 16846, 16932, 17018, 17104, 17190, 17275, 17361, 17446, 17531, 17616, 17700, 17785, 17869, 17953, 18037, 18121, 18205, 18288, 18372, 18455, 18538, 18621, 18703, 18786, 18868, 18950, 19032, 19114, 19195, 19277, 19358, 19439, 19520, 19601, 19681, 19761, 19841, 19921, 20001, 20081, 20160, 20239, 20318, 20397, 20475, 20554, 20632, 20710, 20788, 20865, 20943, 21020, 21097, 21174, 21251, 21327, 21403, 21479, 21555, 21631, 21706, 21781, 21856, 21931, 22006, 22080, 22154, 22228, 22302, 22375, 22449, 22522, 22595, 22668, 22740, 22812, 22884, 22956, 23028, 23099, 23170, 23241, 23312, 23383, 23453, 23523, 23593, 23663, 23732, 23801, 23870, 23939, 24008, 24076, 24144, 24212, 24279, 24347, 24414, 24481, 24548, 24614, 24680, 24746, 24812, 24878, 24943, 25008, 25073, 25138, 25202, 25266, 25330, 25394, 25457, 25520, 25583, 25646, 25708, 25771, 25833, 25894, 25956, 26017, 26078, 26139, 26199, 26259, 26320, 26379, 26439, 26498, 26557, 26616, 26674, 26733, 26791, 26848, 26906, 26963, 27020, 27077, 27133, 27190, 27246, 27301, 27357, 27412, 27467, 27522, 27576, 27630, 27684, 27738, 27791, 27844, 27897, 27950, 28002, 28054, 28106, 28158, 28209, 28260, 28311, 28361, 28411, 28461, 28511, 28560, 28610, 28658, 28707, 28755, 28803, 28851, 28899, 28946, 28993, 29040, 29086, 29132, 29178, 29224, 29269, 29314, 29359, 29404, 29448, 29492, 29535, 29579, 29622, 29665, 29707, 29750, 29792, 29833, 29875, 29916, 29957, 29997, 30038, 30078, 30118, 30157, 30196, 30235, 30274, 30312, 30350, 30388, 30425, 30462, 30499, 30536, 30572, 30608, 30644, 30680, 30715, 30750, 30784, 30819, 30853, 30886, 30920, 30953, 30986, 31018, 31050, 31082, 31114, 31146, 31177, 31207, 31238, 31268, 31298, 31328, 31357, 31386, 31415, 31443, 31471, 31499, 31527, 31554, 31581, 31608, 31634, 31660, 31686, 31711, 31737, 31761, 31786, 31810, 31834, 31858, 31881, 31904, 31927, 31950, 31972, 31994, 32015, 32037, 32058, 32078, 32099, 32119, 32138, 32158, 32177, 32196, 32214, 32233, 32251, 32268, 32286, 32303, 32319, 32336, 32352, 32368, 32383, 32398, 32413, 32428, 32442, 32456, 32470, 32483, 32496, 32509, 32522, 32534, 32546, 32557, 32568, 32579, 32590, 32600, 32610, 32620, 32629, 32638, 32647, 32656, 32664, 32672, 32679, 32686, 32693, 32700, 32706, 32712, 32718, 32723, 32729, 32733, 32738, 32742, 32746, 32749, 32753, 32756, 32758, 32760, 32762, 32764, 32766, 32767, 32767, 32767};
const short sin_ang[N] = { 0, 101, 201, 302, 402, 503, 603, 704, 804, 905, 1005, 1106, 1206, 1307, 1407, 1507, 1608, 1708, 1809, 1909, 2009, 2110, 2210, 2310, 2411, 2511, 2611, 2711, 2811, 2912, 3012, 3112, 3212, 3312, 3412, 3512, 3612, 3712, 3812, 3911, 4011, 4111, 4211, 4310, 4410, 4510, 4609, 4709, 4808, 4907, 5007, 5106, 5205, 5305, 5404, 5503, 5602, 5701, 5800, 5899, 5998, 6097, 6195, 6294, 6393, 6491, 6590, 6688, 6787, 6885, 6983, 7081, 7180, 7278, 7376, 7473, 7571, 7669, 7767, 7864, 7962, 8059, 8157, 8254, 8351, 8449, 8546, 8643, 8740, 8836, 8933, 9030, 9127, 9223, 9319, 9416, 9512, 9608, 9704, 9800, 9896, 9992, 10088, 10183, 10279, 10374, 10469, 10565, 10660, 10755, 10850, 10945, 11039, 11134, 11228, 11323, 11417, 11511, 11605, 11699, 11793, 11887, 11980, 12074, 12167, 12261, 12354, 12447, 12540, 12633, 12725, 12818, 12910, 13003, 13095, 13187, 13279, 13371, 13463, 13554, 13646, 13737, 13828, 13919, 14010, 14101, 14192, 14282, 14373, 14463, 14553, 14643, 14733, 14823, 14912, 15002, 15091, 15180, 15269, 15358, 15447, 15535, 15624, 15712, 15800, 15888, 15976, 16064, 16151, 16239, 16326, 16413, 16500, 16587, 16673, 16760, 16846, 16932, 17018, 17104, 17190, 17275, 17361, 17446, 17531, 17616, 17700, 17785, 17869, 17953, 18037, 18121, 18205, 18288, 18372, 18455, 18538, 18621, 18703, 18786, 18868, 18950, 19032, 19114, 19195, 19277, 19358, 19439, 19520, 19601, 19681, 19761, 19841, 19921, 20001, 20081, 20160, 20239, 20318, 20397, 20475, 20554, 20632, 20710, 20788, 20865, 20943, 21020, 21097, 21174, 21251, 21327, 21403, 21479, 21555, 21631, 21706, 21781, 21856, 21931, 22006, 22080, 22154, 22228, 22302, 22375, 22449, 22522, 22595, 22668, 22740, 22812, 22884, 22956, 23028, 23099, 23170, 23241, 23312, 23383, 23453, 23523, 23593, 23663, 23732, 23801, 23870, 23939, 24008, 24076, 24144, 24212, 24279, 24347, 24414, 24481, 24548, 24614, 24680, 24746, 24812, 24878, 24943, 25008, 25073, 25138, 25202, 25266, 25330, 25394, 25457, 25520, 25583, 25646, 25708, 25771, 25833, 25894, 25956, 26017, 26078, 26139, 26199, 26259, 26320, 26379, 26439, 26498, 26557, 26616, 26674, 26733, 26791, 26848, 26906, 26963, 27020, 27077, 27133, 27190, 27246, 27301, 27357, 27412, 27467, 27522, 27576, 27630, 27684, 27738, 27791, 27844, 27897, 27950, 28002, 28054, 28106, 28158, 28209, 28260, 28311, 28361, 28411, 28461, 28511, 28560, 28610, 28658, 28707, 28755, 28803, 28851, 28899, 28946, 28993, 29040, 29086, 29132, 29178, 29224, 29269, 29314, 29359, 29404, 29448, 29492, 29535, 29579, 29622, 29665, 29707, 29750, 29792, 29833, 29875, 29916, 29957, 29997, 30038, 30078, 30118, 30157, 30196, 30235, 30274, 30312, 30350, 30388, 30425, 30462, 30499, 30536, 30572, 30608, 30644, 30680, 30715, 30750, 30784, 30819, 30853, 30886, 30920, 30953, 30986, 31018, 31050, 31082, 31114, 31146, 31177, 31207, 31238, 31268, 31298, 31328, 31357, 31386, 31415, 31443, 31471, 31499, 31527, 31554, 31581, 31608, 31634, 31660, 31686, 31711, 31737, 31761, 31786, 31810, 31834, 31858, 31881, 31904, 31927, 31950, 31972, 31994, 32015, 32037, 32058, 32078, 32099, 32119, 32138, 32158, 32177, 32196, 32214, 32233, 32251, 32268, 32286, 32303, 32319, 32336, 32352, 32368, 32383, 32398, 32413, 32428, 32442, 32456, 32470, 32483, 32496, 32509, 32522, 32534, 32546, 32557, 32568, 32579, 32590, 32600, 32610, 32620, 32629, 32638, 32647, 32656, 32664, 32672, 32679, 32686, 32693, 32700, 32706, 32712, 32718, 32723, 32729, 32733, 32738, 32742, 32746, 32749, 32753, 32756, 32758, 32760, 32762, 32764, 32766, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32766, 32764, 32762, 32760, 32758, 32756, 32753, 32749, 32746, 32742, 32738, 32733, 32729, 32723, 32718, 32712, 32706, 32700, 32693, 32686, 32679, 32672, 32664, 32656, 32647, 32638, 32629, 32620, 32610, 32600, 32590, 32579, 32568, 32557, 32546, 32534, 32522, 32509, 32496, 32483, 32470, 32456, 32442, 32428, 32413, 32398, 32383, 32368, 32352, 32336, 32319, 32303, 32286, 32268, 32251, 32233, 32214, 32196, 32177, 32158, 32138, 32119, 32099, 32078, 32058, 32037, 32015, 31994, 31972, 31950, 31927, 31904, 31881, 31858, 31834, 31810, 31786, 31761, 31737, 31711, 31686, 31660, 31634, 31608, 31581, 31554, 31527, 31499, 31471, 31443, 31415, 31386, 31357, 31328, 31298, 31268, 31238, 31207, 31177, 31146, 31114, 31082, 31050, 31018, 30986, 30953, 30920, 30886, 30853, 30819, 30784, 30750, 30715, 30680, 30644, 30608, 30572, 30536, 30499, 30462, 30425, 30388, 30350, 30312, 30274, 30235, 30196, 30157, 30118, 30078, 30038, 29997, 29957, 29916, 29875, 29833, 29792, 29750, 29707, 29665, 29622, 29579, 29535, 29492, 29448, 29404, 29359, 29314, 29269, 29224, 29178, 29132, 29086, 29040, 28993, 28946, 28899, 28851, 28803, 28755, 28707, 28658, 28610, 28560, 28511, 28461, 28411, 28361, 28311, 28260, 28209, 28158, 28106, 28054, 28002, 27950, 27897, 27844, 27791, 27738, 27684, 27630, 27576, 27522, 27467, 27412, 27357, 27301, 27246, 27190, 27133, 27077, 27020, 26963, 26906, 26848, 26791, 26733, 26674, 26616, 26557, 26498, 26439, 26379, 26320, 26259, 26199, 26139, 26078, 26017, 25956, 25894, 25833, 25771, 25708, 25646, 25583, 25520, 25457, 25394, 25330, 25266, 25202, 25138, 25073, 25008, 24943, 24878, 24812, 24746, 24680, 24614, 24548, 24481, 24414, 24347, 24279, 24212, 24144, 24076, 24008, 23939, 23870, 23801, 23732, 23663, 23593, 23523, 23453, 23383, 23312, 23241, 23170, 23099, 23028, 22956, 22884, 22812, 22740, 22668, 22595, 22522, 22449, 22375, 22302, 22228, 22154, 22080, 22006, 21931, 21856, 21781, 21706, 21631, 21555, 21479, 21403, 21327, 21251, 21174, 21097, 21020, 20943, 20865, 20788, 20710, 20632, 20554, 20475, 20397, 20318, 20239, 20160, 20081, 20001, 19921, 19841, 19761, 19681, 19601, 19520, 19439, 19358, 19277, 19195, 19114, 19032, 18950, 18868, 18786, 18703, 18621, 18538, 18455, 18372, 18288, 18205, 18121, 18037, 17953, 17869, 17785, 17700, 17616, 17531, 17446, 17361, 17275, 17190, 17104, 17018, 16932, 16846, 16760, 16673, 16587, 16500, 16413, 16326, 16239, 16151, 16064, 15976, 15888, 15800, 15712, 15624, 15535, 15447, 15358, 15269, 15180, 15091, 15002, 14912, 14823, 14733, 14643, 14553, 14463, 14373, 14282, 14192, 14101, 14010, 13919, 13828, 13737, 13646, 13554, 13463, 13371, 13279, 13187, 13095, 13003, 12910, 12818, 12725, 12633, 12540, 12447, 12354, 12261, 12167, 12074, 11980, 11887, 11793, 11699, 11605, 11511, 11417, 11323, 11228, 11134, 11039, 10945, 10850, 10755, 10660, 10565, 10469, 10374, 10279, 10183, 10088, 9992, 9896, 9800, 9704, 9608, 9512, 9416, 9319, 9223, 9127, 9030, 8933, 8836, 8740, 8643, 8546, 8449, 8351, 8254, 8157, 8059, 7962, 7864, 7767, 7669, 7571, 7473, 7376, 7278, 7180, 7081, 6983, 6885, 6787, 6688, 6590, 6491, 6393, 6294, 6195, 6097, 5998, 5899, 5800, 5701, 5602, 5503, 5404, 5305, 5205, 5106, 5007, 4907, 4808, 4709, 4609, 4510, 4410, 4310, 4211, 4111, 4011, 3911, 3812, 3712, 3612, 3512, 3412, 3312, 3212, 3112, 3012, 2912, 2811, 2711, 2611, 2511, 2411, 2310, 2210, 2110, 2009, 1909, 1809, 1708, 1608, 1507, 1407, 1307, 1206, 1106, 1005, 905, 804, 704, 603, 503, 402, 302, 201, 101, 0, -101, -201, -302, -402, -503, -603, -704, -804, -905, -1005, -1106, -1206, -1307, -1407, -1507, -1608, -1708, -1809, -1909, -2009, -2110, -2210, -2310, -2411, -2511, -2611, -2711, -2811, -2912, -3012, -3112, -3212, -3312, -3412, -3512, -3612, -3712, -3812, -3911, -4011, -4111, -4211, -4310, -4410, -4510, -4609, -4709, -4808, -4907, -5007, -5106, -5205, -5305, -5404, -5503, -5602, -5701, -5800, -5899, -5998, -6097, -6195, -6294, -6393, -6491, -6590, -6688, -6787, -6885, -6983, -7081, -7180, -7278, -7376, -7473, -7571, -7669, -7767, -7864, -7962, -8059, -8157, -8254, -8351, -8449, -8546, -8643, -8740, -8836, -8933, -9030, -9127, -9223, -9319, -9416, -9512, -9608, -9704, -9800, -9896, -9992, -10088, -10183, -10279, -10374, -10469, -10565, -10660, -10755, -10850, -10945, -11039, -11134, -11228, -11323, -11417, -11511, -11605, -11699, -11793, -11887, -11980, -12074, -12167, -12261, -12354, -12447, -12540, -12633, -12725, -12818, -12910, -13003, -13095, -13187, -13279, -13371, -13463, -13554, -13646, -13737, -13828, -13919, -14010, -14101, -14192, -14282, -14373, -14463, -14553, -14643, -14733, -14823, -14912, -15002, -15091, -15180, -15269, -15358, -15447, -15535, -15624, -15712, -15800, -15888, -15976, -16064, -16151, -16239, -16326, -16413, -16500, -16587, -16673, -16760, -16846, -16932, -17018, -17104, -17190, -17275, -17361, -17446, -17531, -17616, -17700, -17785, -17869, -17953, -18037, -18121, -18205, -18288, -18372, -18455, -18538, -18621, -18703, -18786, -18868, -18950, -19032, -19114, -19195, -19277, -19358, -19439, -19520, -19601, -19681, -19761, -19841, -19921, -20001, -20081, -20160, -20239, -20318, -20397, -20475, -20554, -20632, -20710, -20788, -20865, -20943, -21020, -21097, -21174, -21251, -21327, -21403, -21479, -21555, -21631, -21706, -21781, -21856, -21931, -22006, -22080, -22154, -22228, -22302, -22375, -22449, -22522, -22595, -22668, -22740, -22812, -22884, -22956, -23028, -23099, -23170, -23241, -23312, -23383, -23453, -23523, -23593, -23663, -23732, -23801, -23870, -23939, -24008, -24076, -24144, -24212, -24279, -24347, -24414, -24481, -24548, -24614, -24680, -24746, -24812, -24878, -24943, -25008, -25073, -25138, -25202, -25266, -25330, -25394, -25457, -25520, -25583, -25646, -25708, -25771, -25833, -25894, -25956, -26017, -26078, -26139, -26199, -26259, -26320, -26379, -26439, -26498, -26557, -26616, -26674, -26733, -26791, -26848, -26906, -26963, -27020, -27077, -27133, -27190, -27246, -27301, -27357, -27412, -27467, -27522, -27576, -27630, -27684, -27738, -27791, -27844, -27897, -27950, -28002, -28054, -28106, -28158, -28209, -28260, -28311, -28361, -28411, -28461, -28511, -28560, -28610, -28658, -28707, -28755, -28803, -28851, -28899, -28946, -28993, -29040, -29086, -29132, -29178, -29224, -29269, -29314, -29359, -29404, -29448, -29492, -29535, -29579, -29622, -29665, -29707, -29750, -29792, -29833, -29875, -29916, -29957, -29997, -30038, -30078, -30118, -30157, -30196, -30235, -30274, -30312, -30350, -30388, -30425, -30462, -30499, -30536, -30572, -30608, -30644, -30680, -30715, -30750, -30784, -30819, -30853, -30886, -30920, -30953, -30986, -31018, -31050, -31082, -31114, -31146, -31177, -31207, -31238, -31268, -31298, -31328, -31357, -31386, -31415, -31443, -31471, -31499, -31527, -31554, -31581, -31608, -31634, -31660, -31686, -31711, -31737, -31761, -31786, -31810, -31834, -31858, -31881, -31904, -31927, -31950, -31972, -31994, -32015, -32037, -32058, -32078, -32099, -32119, -32138, -32158, -32177, -32196, -32214, -32233, -32251, -32268, -32286, -32303, -32319, -32336, -32352, -32368, -32383, -32398, -32413, -32428, -32442, -32456, -32470, -32483, -32496, -32509, -32522, -32534, -32546, -32557, -32568, -32579, -32590, -32600, -32610, -32620, -32629, -32638, -32647, -32656, -32664, -32672, -32679, -32686, -32693, -32700, -32706, -32712, -32718, -32723, -32729, -32733, -32738, -32742, -32746, -32749, -32753, -32756, -32758, -32760, -32762, -32764, -32766, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32766, -32764, -32762, -32760, -32758, -32756, -32753, -32749, -32746, -32742, -32738, -32733, -32729, -32723, -32718, -32712, -32706, -32700, -32693, -32686, -32679, -32672, -32664, -32656, -32647, -32638, -32629, -32620, -32610, -32600, -32590, -32579, -32568, -32557, -32546, -32534, -32522, -32509, -32496, -32483, -32470, -32456, -32442, -32428, -32413, -32398, -32383, -32368, -32352, -32336, -32319, -32303, -32286, -32268, -32251, -32233, -32214, -32196, -32177, -32158, -32138, -32119, -32099, -32078, -32058, -32037, -32015, -31994, -31972, -31950, -31927, -31904, -31881, -31858, -31834, -31810, -31786, -31761, -31737, -31711, -31686, -31660, -31634, -31608, -31581, -31554, -31527, -31499, -31471, -31443, -31415, -31386, -31357, -31328, -31298, -31268, -31238, -31207, -31177, -31146, -31114, -31082, -31050, -31018, -30986, -30953, -30920, -30886, -30853, -30819, -30784, -30750, -30715, -30680, -30644, -30608, -30572, -30536, -30499, -30462, -30425, -30388, -30350, -30312, -30274, -30235, -30196, -30157, -30118, -30078, -30038, -29997, -29957, -29916, -29875, -29833, -29792, -29750, -29707, -29665, -29622, -29579, -29535, -29492, -29448, -29404, -29359, -29314, -29269, -29224, -29178, -29132, -29086, -29040, -28993, -28946, -28899, -28851, -28803, -28755, -28707, -28658, -28610, -28560, -28511, -28461, -28411, -28361, -28311, -28260, -28209, -28158, -28106, -28054, -28002, -27950, -27897, -27844, -27791, -27738, -27684, -27630, -27576, -27522, -27467, -27412, -27357, -27301, -27246, -27190, -27133, -27077, -27020, -26963, -26906, -26848, -26791, -26733, -26674, -26616, -26557, -26498, -26439, -26379, -26320, -26259, -26199, -26139, -26078, -26017, -25956, -25894, -25833, -25771, -25708, -25646, -25583, -25520, -25457, -25394, -25330, -25266, -25202, -25138, -25073, -25008, -24943, -24878, -24812, -24746, -24680, -24614, -24548, -24481, -24414, -24347, -24279, -24212, -24144, -24076, -24008, -23939, -23870, -23801, -23732, -23663, -23593, -23523, -23453, -23383, -23312, -23241, -23170, -23099, -23028, -22956, -22884, -22812, -22740, -22668, -22595, -22522, -22449, -22375, -22302, -22228, -22154, -22080, -22006, -21931, -21856, -21781, -21706, -21631, -21555, -21479, -21403, -21327, -21251, -21174, -21097, -21020, -20943, -20865, -20788, -20710, -20632, -20554, -20475, -20397, -20318, -20239, -20160, -20081, -20001, -19921, -19841, -19761, -19681, -19601, -19520, -19439, -19358, -19277, -19195, -19114, -19032, -18950, -18868, -18786, -18703, -18621, -18538, -18455, -18372, -18288, -18205, -18121, -18037, -17953, -17869, -17785, -17700, -17616, -17531, -17446, -17361, -17275, -17190, -17104, -17018, -16932, -16846, -16760, -16673, -16587, -16500, -16413, -16326, -16239, -16151, -16064, -15976, -15888, -15800, -15712, -15624, -15535, -15447, -15358, -15269, -15180, -15091, -15002, -14912, -14823, -14733, -14643, -14553, -14463, -14373, -14282, -14192, -14101, -14010, -13919, -13828, -13737, -13646, -13554, -13463, -13371, -13279, -13187, -13095, -13003, -12910, -12818, -12725, -12633, -12540, -12447, -12354, -12261, -12167, -12074, -11980, -11887, -11793, -11699, -11605, -11511, -11417, -11323, -11228, -11134, -11039, -10945, -10850, -10755, -10660, -10565, -10469, -10374, -10279, -10183, -10088, -9992, -9896, -9800, -9704, -9608, -9512, -9416, -9319, -9223, -9127, -9030, -8933, -8836, -8740, -8643, -8546, -8449, -8351, -8254, -8157, -8059, -7962, -7864, -7767, -7669, -7571, -7473, -7376, -7278, -7180, -7081, -6983, -6885, -6787, -6688, -6590, -6491, -6393, -6294, -6195, -6097, -5998, -5899, -5800, -5701, -5602, -5503, -5404, -5305, -5205, -5106, -5007, -4907, -4808, -4709, -4609, -4510, -4410, -4310, -4211, -4111, -4011, -3911, -3812, -3712, -3612, -3512, -3412, -3312, -3212, -3112, -3012, -2912, -2811, -2711, -2611, -2511, -2411, -2310, -2210, -2110, -2009, -1909, -1809, -1708, -1608, -1507, -1407, -1307, -1206, -1106, -1005, -905, -804, -704, -603, -503, -402, -302, -201, -100};
#endif

#ifdef N_1024
const int hanningTab[N]={ 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 4, 4, 5, 5, 5, 6, 6, 7, 7, 8, 8, 9, 10, 10, 11, 12, 12, 13, 14, 14, 15, 16, 17, 17, 18, 19, 20, 21, 22, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 37, 38, 39, 41, 42, 43, 44, 46, 47, 48, 49, 51, 52, 53, 55, 56, 58, 59, 61, 62, 64, 65, 67, 68, 70, 71, 73, 74, 76, 78, 79, 81, 83, 84, 86, 88, 90, 91, 93, 95, 97, 99, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124, 126, 128, 130, 132, 134, 136, 138, 140, 142, 145, 147, 149, 151, 153, 156, 158, 160, 162, 165, 167, 169, 171, 174, 176, 178, 181, 183, 186, 188, 190, 193, 195, 198, 200, 203, 205, 207, 210, 212, 215, 218, 220, 223, 225, 228, 230, 233, 236, 238, 241, 243, 246, 249, 251, 254, 257, 259, 262, 265, 267, 270, 273, 276, 278, 281, 284, 287, 290, 292, 295, 298, 301, 304, 306, 309, 312, 315, 318, 321, 323, 326, 329, 332, 335, 338, 341, 344, 347, 350, 353, 355, 358, 361, 364, 367, 370, 373, 376, 379, 382, 385, 388, 391, 394, 397, 400, 403, 406, 409, 412, 415, 418, 421, 424, 427, 430, 433, 436, 439, 443, 446, 449, 452, 455, 458, 461, 464, 467, 470, 473, 476, 479, 482, 485, 488, 492, 495, 498, 501, 504, 507, 510, 513, 516, 519, 522, 525, 528, 531, 535, 538, 541, 544, 547, 550, 553, 556, 559, 562, 565, 568, 571, 574, 577, 580, 583, 586, 589, 592, 595, 598, 601, 604, 607, 610, 613, 616, 619, 622, 625, 628, 631, 634, 637, 640, 643, 646, 649, 652, 655, 658, 661, 664, 666, 669, 672, 675, 678, 681, 684, 687, 689, 692, 695, 698, 701, 704, 706, 709, 712, 715, 717, 720, 723, 726, 728, 731, 734, 737, 739, 742, 745, 747, 750, 753, 755, 758, 761, 763, 766, 768, 771, 774, 776, 779, 781, 784, 786, 789, 791, 794, 796, 799, 801, 804, 806, 808, 811, 813, 816, 818, 820, 823, 825, 827, 830, 832, 834, 837, 839, 841, 843, 846, 848, 850, 852, 854, 857, 859, 861, 863, 865, 867, 869, 871, 873, 875, 877, 879, 881, 883, 885, 887, 889, 891, 893, 895, 897, 899, 901, 902, 904, 906, 908, 910, 911, 913, 915, 916, 918, 920, 921, 923, 925, 926, 928, 930, 931, 933, 934, 936, 937, 939, 940, 942, 943, 944, 946, 947, 949, 950, 951, 953, 954, 955, 956, 958, 959, 960, 961, 962, 964, 965, 966, 967, 968, 969, 970, 971, 972, 973, 974, 975, 976, 977, 978, 979, 980, 981, 981, 982, 983, 984, 985, 985, 986, 987, 987, 988, 989, 989, 990, 991, 991, 992, 992, 993, 993, 994, 994, 995, 995, 996, 996, 996, 997, 997, 997, 998, 998, 998, 999, 999, 999, 999, 999, 999, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 999, 999, 999, 999, 999, 999, 998, 998, 998, 997, 997, 997, 996, 996, 996, 995, 995, 994, 994, 993, 993, 992, 992, 991, 991, 990, 989, 989, 988, 987, 987, 986, 985, 985, 984, 983, 982, 981, 981, 980, 979, 978, 977, 976, 975, 974, 973, 972, 971, 970, 969, 968, 967, 966, 965, 964, 962, 961, 960, 959, 958, 956, 955, 954, 953, 951, 950, 949, 947, 946, 944, 943, 942, 940, 939, 937, 936, 934, 933, 931, 930, 928, 926, 925, 923, 921, 920, 918, 916, 915, 913, 911, 910, 908, 906, 904, 902, 901, 899, 897, 895, 893, 891, 889, 887, 885, 883, 881, 879, 877, 875, 873, 871, 869, 867, 865, 863, 861, 859, 857, 854, 852, 850, 848, 846, 843, 841, 839, 837, 834, 832, 830, 827, 825, 823, 820, 818, 816, 813, 811, 808, 806, 804, 801, 799, 796, 794, 791, 789, 786, 784, 781, 779, 776, 774, 771, 768, 766, 763, 761, 758, 755, 753, 750, 747, 745, 742, 739, 737, 734, 731, 728, 726, 723, 720, 717, 715, 712, 709, 706, 704, 701, 698, 695, 692, 689, 687, 684, 681, 678, 675, 672, 669, 666, 664, 661, 658, 655, 652, 649, 646, 643, 640, 637, 634, 631, 628, 625, 622, 619, 616, 613, 610, 607, 604, 601, 598, 595, 592, 589, 586, 583, 580, 577, 574, 571, 568, 565, 562, 559, 556, 553, 550, 547, 544, 541, 538, 535, 531, 528, 525, 522, 519, 516, 513, 510, 507, 504, 501, 498, 495, 492, 488, 485, 482, 479, 476, 473, 470, 467, 464, 461, 458, 455, 452, 449, 446, 443, 439, 436, 433, 430, 427, 424, 421, 418, 415, 412, 409, 406, 403, 400, 397, 394, 391, 388, 385, 382, 379, 376, 373, 370, 367, 364, 361, 358, 355, 353, 350, 347, 344, 341, 338, 335, 332, 329, 326, 323, 321, 318, 315, 312, 309, 306, 304, 301, 298, 295, 292, 290, 287, 284, 281, 278, 276, 273, 270, 267, 265, 262, 259, 257, 254, 251, 249, 246, 243, 241, 238, 236, 233, 230, 228, 225, 223, 220, 218, 215, 212, 210, 207, 205, 203, 200, 198, 195, 193, 190, 188, 186, 183, 181, 178, 176, 174, 171, 169, 167, 165, 162, 160, 158, 156, 153, 151, 149, 147, 145, 142, 140, 138, 136, 134, 132, 130, 128, 126, 124, 122, 120, 118, 116, 114, 112, 110, 108, 106, 104, 102, 100, 99, 97, 95, 93, 91, 90, 88, 86, 84, 83, 81, 79, 78, 76, 74, 73, 71, 70, 68, 67, 65, 64, 62, 61, 59, 58, 56, 55, 53, 52, 51, 49, 48, 47, 46, 44, 43, 42, 41, 39, 38, 37, 36, 35, 34, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 22, 21, 20, 19, 18, 17, 17, 16, 15, 14, 14, 13, 12, 12, 11, 10, 10, 9, 8, 8, 7, 7, 6, 6, 5, 5, 5, 4, 4, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0};
const short cos_ang[N] = { 32767, 32767, 32766, 32762, 32758, 32753, 32746, 32738, 32729, 32718, 32706, 32693, 32679, 32664, 32647, 32629, 32610, 32590, 32568, 32546, 32522, 32496, 32470, 32442, 32413, 32383, 32352, 32319, 32286, 32251, 32214, 32177, 32138, 32099, 32058, 32015, 31972, 31927, 31881, 31834, 31786, 31737, 31686, 31634, 31581, 31527, 31471, 31415, 31357, 31298, 31238, 31177, 31114, 31050, 30986, 30920, 30853, 30784, 30715, 30644, 30572, 30499, 30425, 30350, 30274, 30196, 30118, 30038, 29957, 29875, 29792, 29707, 29622, 29535, 29448, 29359, 29269, 29178, 29086, 28993, 28899, 28803, 28707, 28610, 28511, 28411, 28311, 28209, 28106, 28002, 27897, 27791, 27684, 27576, 27467, 27357, 27246, 27133, 27020, 26906, 26791, 26674, 26557, 26439, 26320, 26199, 26078, 25956, 25833, 25708, 25583, 25457, 25330, 25202, 25073, 24943, 24812, 24680, 24548, 24414, 24279, 24144, 24008, 23870, 23732, 23593, 23453, 23312, 23170, 23028, 22884, 22740, 22595, 22449, 22302, 22154, 22006, 21856, 21706, 21555, 21403, 21251, 21097, 20943, 20788, 20632, 20475, 20318, 20160, 20001, 19841, 19681, 19520, 19358, 19195, 19032, 18868, 18703, 18538, 18372, 18205, 18037, 17869, 17700, 17531, 17361, 17190, 17018, 16846, 16673, 16500, 16326, 16151, 15976, 15800, 15624, 15447, 15269, 15091, 14912, 14733, 14553, 14373, 14192, 14010, 13828, 13646, 13463, 13279, 13095, 12910, 12725, 12540, 12354, 12167, 11980, 11793, 11605, 11417, 11228, 11039, 10850, 10660, 10469, 10279, 10088, 9896, 9704, 9512, 9319, 9127, 8933, 8740, 8546, 8351, 8157, 7962, 7767, 7571, 7376, 7180, 6983, 6787, 6590, 6393, 6195, 5998, 5800, 5602, 5404, 5205, 5007, 4808, 4609, 4410, 4211, 4011, 3812, 3612, 3412, 3212, 3012, 2811, 2611, 2411, 2210, 2009, 1809, 1608, 1407, 1206, 1005, 804, 603, 402, 201, 0, -201, -402, -603, -804, -1005, -1206, -1407, -1608, -1809, -2009, -2210, -2411, -2611, -2811, -3012, -3212, -3412, -3612, -3812, -4011, -4211, -4410, -4609, -4808, -5007, -5205, -5404, -5602, -5800, -5998, -6195, -6393, -6590, -6787, -6983, -7180, -7376, -7571, -7767, -7962, -8157, -8351, -8546, -8740, -8933, -9127, -9319, -9512, -9704, -9896, -10088, -10279, -10469, -10660, -10850, -11039, -11228, -11417, -11605, -11793, -11980, -12167, -12354, -12540, -12725, -12910, -13095, -13279, -13463, -13646, -13828, -14010, -14192, -14373, -14553, -14733, -14912, -15091, -15269, -15447, -15624, -15800, -15976, -16151, -16326, -16500, -16673, -16846, -17018, -17190, -17361, -17531, -17700, -17869, -18037, -18205, -18372, -18538, -18703, -18868, -19032, -19195, -19358, -19520, -19681, -19841, -20001, -20160, -20318, -20475, -20632, -20788, -20943, -21097, -21251, -21403, -21555, -21706, -21856, -22006, -22154, -22302, -22449, -22595, -22740, -22884, -23028, -23170, -23312, -23453, -23593, -23732, -23870, -24008, -24144, -24279, -24414, -24548, -24680, -24812, -24943, -25073, -25202, -25330, -25457, -25583, -25708, -25833, -25956, -26078, -26199, -26320, -26439, -26557, -26674, -26791, -26906, -27020, -27133, -27246, -27357, -27467, -27576, -27684, -27791, -27897, -28002, -28106, -28209, -28311, -28411, -28511, -28610, -28707, -28803, -28899, -28993, -29086, -29178, -29269, -29359, -29448, -29535, -29622, -29707, -29792, -29875, -29957, -30038, -30118, -30196, -30274, -30350, -30425, -30499, -30572, -30644, -30715, -30784, -30853, -30920, -30986, -31050, -31114, -31177, -31238, -31298, -31357, -31415, -31471, -31527, -31581, -31634, -31686, -31737, -31786, -31834, -31881, -31927, -31972, -32015, -32058, -32099, -32138, -32177, -32214, -32251, -32286, -32319, -32352, -32383, -32413, -32442, -32470, -32496, -32522, -32546, -32568, -32590, -32610, -32629, -32647, -32664, -32679, -32693, -32706, -32718, -32729, -32738, -32746, -32753, -32758, -32762, -32766, -32767, -32767, -32767, -32766, -32762, -32758, -32753, -32746, -32738, -32729, -32718, -32706, -32693, -32679, -32664, -32647, -32629, -32610, -32590, -32568, -32546, -32522, -32496, -32470, -32442, -32413, -32383, -32352, -32319, -32286, -32251, -32214, -32177, -32138, -32099, -32058, -32015, -31972, -31927, -31881, -31834, -31786, -31737, -31686, -31634, -31581, -31527, -31471, -31415, -31357, -31298, -31238, -31177, -31114, -31050, -30986, -30920, -30853, -30784, -30715, -30644, -30572, -30499, -30425, -30350, -30274, -30196, -30118, -30038, -29957, -29875, -29792, -29707, -29622, -29535, -29448, -29359, -29269, -29178, -29086, -28993, -28899, -28803, -28707, -28610, -28511, -28411, -28311, -28209, -28106, -28002, -27897, -27791, -27684, -27576, -27467, -27357, -27246, -27133, -27020, -26906, -26791, -26674, -26557, -26439, -26320, -26199, -26078, -25956, -25833, -25708, -25583, -25457, -25330, -25202, -25073, -24943, -24812, -24680, -24548, -24414, -24279, -24144, -24008, -23870, -23732, -23593, -23453, -23312, -23170, -23028, -22884, -22740, -22595, -22449, -22302, -22154, -22006, -21856, -21706, -21555, -21403, -21251, -21097, -20943, -20788, -20632, -20475, -20318, -20160, -20001, -19841, -19681, -19520, -19358, -19195, -19032, -18868, -18703, -18538, -18372, -18205, -18037, -17869, -17700, -17531, -17361, -17190, -17018, -16846, -16673, -16500, -16326, -16151, -15976, -15800, -15624, -15447, -15269, -15091, -14912, -14733, -14553, -14373, -14192, -14010, -13828, -13646, -13463, -13279, -13095, -12910, -12725, -12540, -12354, -12167, -11980, -11793, -11605, -11417, -11228, -11039, -10850, -10660, -10469, -10279, -10088, -9896, -9704, -9512, -9319, -9127, -8933, -8740, -8546, -8351, -8157, -7962, -7767, -7571, -7376, -7180, -6983, -6787, -6590, -6393, -6195, -5998, -5800, -5602, -5404, -5205, -5007, -4808, -4609, -4410, -4211, -4011, -3812, -3612, -3412, -3212, -3012, -2811, -2611, -2411, -2210, -2009, -1809, -1608, -1407, -1206, -1005, -804, -603, -402, -201, 0, 201, 402, 603, 804, 1005, 1206, 1407, 1608, 1809, 2009, 2210, 2411, 2611, 2811, 3012, 3212, 3412, 3612, 3812, 4011, 4211, 4410, 4609, 4808, 5007, 5205, 5404, 5602, 5800, 5998, 6195, 6393, 6590, 6787, 6983, 7180, 7376, 7571, 7767, 7962, 8157, 8351, 8546, 8740, 8933, 9127, 9319, 9512, 9704, 9896, 10088, 10279, 10469, 10660, 10850, 11039, 11228, 11417, 11605, 11793, 11980, 12167, 12354, 12540, 12725, 12910, 13095, 13279, 13463, 13646, 13828, 14010, 14192, 14373, 14553, 14733, 14912, 15091, 15269, 15447, 15624, 15800, 15976, 16151, 16326, 16500, 16673, 16846, 17018, 17190, 17361, 17531, 17700, 17869, 18037, 18205, 18372, 18538, 18703, 18868, 19032, 19195, 19358, 19520, 19681, 19841, 20001, 20160, 20318, 20475, 20632, 20788, 20943, 21097, 21251, 21403, 21555, 21706, 21856, 22006, 22154, 22302, 22449, 22595, 22740, 22884, 23028, 23170, 23312, 23453, 23593, 23732, 23870, 24008, 24144, 24279, 24414, 24548, 24680, 24812, 24943, 25073, 25202, 25330, 25457, 25583, 25708, 25833, 25956, 26078, 26199, 26320, 26439, 26557, 26674, 26791, 26906, 27020, 27133, 27246, 27357, 27467, 27576, 27684, 27791, 27897, 28002, 28106, 28209, 28311, 28411, 28511, 28610, 28707, 28803, 28899, 28993, 29086, 29178, 29269, 29359, 29448, 29535, 29622, 29707, 29792, 29875, 29957, 30038, 30118, 30196, 30274, 30350, 30425, 30499, 30572, 30644, 30715, 30784, 30853, 30920, 30986, 31050, 31114, 31177, 31238, 31298, 31357, 31415, 31471, 31527, 31581, 31634, 31686, 31737, 31786, 31834, 31881, 31927, 31972, 32015, 32058, 32099, 32138, 32177, 32214, 32251, 32286, 32319, 32352, 32383, 32413, 32442, 32470, 32496, 32522, 32546, 32568, 32590, 32610, 32629, 32647, 32664, 32679, 32693, 32706, 32718, 32729, 32738, 32746, 32753, 32758, 32762, 32766, 32767};
const short sin_ang[N] = { 0, 201, 402, 603, 804, 1005, 1206, 1407, 1608, 1809, 2009, 2210, 2411, 2611, 2811, 3012, 3212, 3412, 3612, 3812, 4011, 4211, 4410, 4609, 4808, 5007, 5205, 5404, 5602, 5800, 5998, 6195, 6393, 6590, 6787, 6983, 7180, 7376, 7571, 7767, 7962, 8157, 8351, 8546, 8740, 8933, 9127, 9319, 9512, 9704, 9896, 10088, 10279, 10469, 10660, 10850, 11039, 11228, 11417, 11605, 11793, 11980, 12167, 12354, 12540, 12725, 12910, 13095, 13279, 13463, 13646, 13828, 14010, 14192, 14373, 14553, 14733, 14912, 15091, 15269, 15447, 15624, 15800, 15976, 16151, 16326, 16500, 16673, 16846, 17018, 17190, 17361, 17531, 17700, 17869, 18037, 18205, 18372, 18538, 18703, 18868, 19032, 19195, 19358, 19520, 19681, 19841, 20001, 20160, 20318, 20475, 20632, 20788, 20943, 21097, 21251, 21403, 21555, 21706, 21856, 22006, 22154, 22302, 22449, 22595, 22740, 22884, 23028, 23170, 23312, 23453, 23593, 23732, 23870, 24008, 24144, 24279, 24414, 24548, 24680, 24812, 24943, 25073, 25202, 25330, 25457, 25583, 25708, 25833, 25956, 26078, 26199, 26320, 26439, 26557, 26674, 26791, 26906, 27020, 27133, 27246, 27357, 27467, 27576, 27684, 27791, 27897, 28002, 28106, 28209, 28311, 28411, 28511, 28610, 28707, 28803, 28899, 28993, 29086, 29178, 29269, 29359, 29448, 29535, 29622, 29707, 29792, 29875, 29957, 30038, 30118, 30196, 30274, 30350, 30425, 30499, 30572, 30644, 30715, 30784, 30853, 30920, 30986, 31050, 31114, 31177, 31238, 31298, 31357, 31415, 31471, 31527, 31581, 31634, 31686, 31737, 31786, 31834, 31881, 31927, 31972, 32015, 32058, 32099, 32138, 32177, 32214, 32251, 32286, 32319, 32352, 32383, 32413, 32442, 32470, 32496, 32522, 32546, 32568, 32590, 32610, 32629, 32647, 32664, 32679, 32693, 32706, 32718, 32729, 32738, 32746, 32753, 32758, 32762, 32766, 32767, 32767, 32767, 32766, 32762, 32758, 32753, 32746, 32738, 32729, 32718, 32706, 32693, 32679, 32664, 32647, 32629, 32610, 32590, 32568, 32546, 32522, 32496, 32470, 32442, 32413, 32383, 32352, 32319, 32286, 32251, 32214, 32177, 32138, 32099, 32058, 32015, 31972, 31927, 31881, 31834, 31786, 31737, 31686, 31634, 31581, 31527, 31471, 31415, 31357, 31298, 31238, 31177, 31114, 31050, 30986, 30920, 30853, 30784, 30715, 30644, 30572, 30499, 30425, 30350, 30274, 30196, 30118, 30038, 29957, 29875, 29792, 29707, 29622, 29535, 29448, 29359, 29269, 29178, 29086, 28993, 28899, 28803, 28707, 28610, 28511, 28411, 28311, 28209, 28106, 28002, 27897, 27791, 27684, 27576, 27467, 27357, 27246, 27133, 27020, 26906, 26791, 26674, 26557, 26439, 26320, 26199, 26078, 25956, 25833, 25708, 25583, 25457, 25330, 25202, 25073, 24943, 24812, 24680, 24548, 24414, 24279, 24144, 24008, 23870, 23732, 23593, 23453, 23312, 23170, 23028, 22884, 22740, 22595, 22449, 22302, 22154, 22006, 21856, 21706, 21555, 21403, 21251, 21097, 20943, 20788, 20632, 20475, 20318, 20160, 20001, 19841, 19681, 19520, 19358, 19195, 19032, 18868, 18703, 18538, 18372, 18205, 18037, 17869, 17700, 17531, 17361, 17190, 17018, 16846, 16673, 16500, 16326, 16151, 15976, 15800, 15624, 15447, 15269, 15091, 14912, 14733, 14553, 14373, 14192, 14010, 13828, 13646, 13463, 13279, 13095, 12910, 12725, 12540, 12354, 12167, 11980, 11793, 11605, 11417, 11228, 11039, 10850, 10660, 10469, 10279, 10088, 9896, 9704, 9512, 9319, 9127, 8933, 8740, 8546, 8351, 8157, 7962, 7767, 7571, 7376, 7180, 6983, 6787, 6590, 6393, 6195, 5998, 5800, 5602, 5404, 5205, 5007, 4808, 4609, 4410, 4211, 4011, 3812, 3612, 3412, 3212, 3012, 2811, 2611, 2411, 2210, 2009, 1809, 1608, 1407, 1206, 1005, 804, 603, 402, 201, 0, -201, -402, -603, -804, -1005, -1206, -1407, -1608, -1809, -2009, -2210, -2411, -2611, -2811, -3012, -3212, -3412, -3612, -3812, -4011, -4211, -4410, -4609, -4808, -5007, -5205, -5404, -5602, -5800, -5998, -6195, -6393, -6590, -6787, -6983, -7180, -7376, -7571, -7767, -7962, -8157, -8351, -8546, -8740, -8933, -9127, -9319, -9512, -9704, -9896, -10088, -10279, -10469, -10660, -10850, -11039, -11228, -11417, -11605, -11793, -11980, -12167, -12354, -12540, -12725, -12910, -13095, -13279, -13463, -13646, -13828, -14010, -14192, -14373, -14553, -14733, -14912, -15091, -15269, -15447, -15624, -15800, -15976, -16151, -16326, -16500, -16673, -16846, -17018, -17190, -17361, -17531, -17700, -17869, -18037, -18205, -18372, -18538, -18703, -18868, -19032, -19195, -19358, -19520, -19681, -19841, -20001, -20160, -20318, -20475, -20632, -20788, -20943, -21097, -21251, -21403, -21555, -21706, -21856, -22006, -22154, -22302, -22449, -22595, -22740, -22884, -23028, -23170, -23312, -23453, -23593, -23732, -23870, -24008, -24144, -24279, -24414, -24548, -24680, -24812, -24943, -25073, -25202, -25330, -25457, -25583, -25708, -25833, -25956, -26078, -26199, -26320, -26439, -26557, -26674, -26791, -26906, -27020, -27133, -27246, -27357, -27467, -27576, -27684, -27791, -27897, -28002, -28106, -28209, -28311, -28411, -28511, -28610, -28707, -28803, -28899, -28993, -29086, -29178, -29269, -29359, -29448, -29535, -29622, -29707, -29792, -29875, -29957, -30038, -30118, -30196, -30274, -30350, -30425, -30499, -30572, -30644, -30715, -30784, -30853, -30920, -30986, -31050, -31114, -31177, -31238, -31298, -31357, -31415, -31471, -31527, -31581, -31634, -31686, -31737, -31786, -31834, -31881, -31927, -31972, -32015, -32058, -32099, -32138, -32177, -32214, -32251, -32286, -32319, -32352, -32383, -32413, -32442, -32470, -32496, -32522, -32546, -32568, -32590, -32610, -32629, -32647, -32664, -32679, -32693, -32706, -32718, -32729, -32738, -32746, -32753, -32758, -32762, -32766, -32767, -32767, -32767, -32766, -32762, -32758, -32753, -32746, -32738, -32729, -32718, -32706, -32693, -32679, -32664, -32647, -32629, -32610, -32590, -32568, -32546, -32522, -32496, -32470, -32442, -32413, -32383, -32352, -32319, -32286, -32251, -32214, -32177, -32138, -32099, -32058, -32015, -31972, -31927, -31881, -31834, -31786, -31737, -31686, -31634, -31581, -31527, -31471, -31415, -31357, -31298, -31238, -31177, -31114, -31050, -30986, -30920, -30853, -30784, -30715, -30644, -30572, -30499, -30425, -30350, -30274, -30196, -30118, -30038, -29957, -29875, -29792, -29707, -29622, -29535, -29448, -29359, -29269, -29178, -29086, -28993, -28899, -28803, -28707, -28610, -28511, -28411, -28311, -28209, -28106, -28002, -27897, -27791, -27684, -27576, -27467, -27357, -27246, -27133, -27020, -26906, -26791, -26674, -26557, -26439, -26320, -26199, -26078, -25956, -25833, -25708, -25583, -25457, -25330, -25202, -25073, -24943, -24812, -24680, -24548, -24414, -24279, -24144, -24008, -23870, -23732, -23593, -23453, -23312, -23170, -23028, -22884, -22740, -22595, -22449, -22302, -22154, -22006, -21856, -21706, -21555, -21403, -21251, -21097, -20943, -20788, -20632, -20475, -20318, -20160, -20001, -19841, -19681, -19520, -19358, -19195, -19032, -18868, -18703, -18538, -18372, -18205, -18037, -17869, -17700, -17531, -17361, -17190, -17018, -16846, -16673, -16500, -16326, -16151, -15976, -15800, -15624, -15447, -15269, -15091, -14912, -14733, -14553, -14373, -14192, -14010, -13828, -13646, -13463, -13279, -13095, -12910, -12725, -12540, -12354, -12167, -11980, -11793, -11605, -11417, -11228, -11039, -10850, -10660, -10469, -10279, -10088, -9896, -9704, -9512, -9319, -9127, -8933, -8740, -8546, -8351, -8157, -7962, -7767, -7571, -7376, -7180, -6983, -6787, -6590, -6393, -6195, -5998, -5800, -5602, -5404, -5205, -5007, -4808, -4609, -4410, -4211, -4011, -3812, -3612, -3412, -3212, -3012, -2811, -2611, -2411, -2210, -2009, -1809, -1608, -1407, -1206, -1005, -804, -603, -402, -201};
#endif

#ifdef N_256
const int hanningTab[N]={ 0, 0, 1, 1, 2, 4, 5, 7, 10, 12, 15, 18, 22, 25, 29, 34, 38, 43, 48, 54, 59, 65, 72, 78, 85, 92, 99, 107, 114, 122, 130, 139, 148, 156, 165, 175, 184, 194, 204, 214, 224, 234, 245, 255, 266, 277, 288, 299, 311, 322, 334, 345, 357, 369, 381, 393, 405, 417, 429, 442, 454, 466, 478, 491, 503, 515, 528, 540, 552, 564, 577, 589, 601, 613, 625, 637, 649, 660, 672, 683, 695, 706, 717, 728, 739, 750, 761, 771, 781, 791, 801, 811, 821, 830, 839, 848, 857, 865, 874, 882, 890, 897, 905, 912, 918, 925, 931, 938, 943, 949, 954, 959, 964, 968, 973, 976, 980, 983, 986, 989, 991, 994, 995, 997, 998, 999, 1000, 1000, 1000, 1000, 999, 998, 997, 995, 994, 991, 989, 986, 983, 980, 976, 973, 968, 964, 959, 954, 949, 943, 938, 931, 925, 918, 912, 905, 897, 890, 882, 874, 865, 857, 848, 839, 830, 821, 811, 801, 791, 781, 771, 761, 750, 739, 728, 717, 706, 695, 683, 672, 660, 649, 637, 625, 613, 601, 589, 577, 564, 552, 540, 528, 515, 503, 491, 478, 466, 454, 442, 429, 417, 405, 393, 381, 369, 357, 345, 334, 322, 311, 299, 288, 277, 266, 255, 245, 234, 224, 214, 204, 194, 184, 175, 165, 156, 148, 139, 130, 122, 114, 107, 99, 92, 85, 78, 72, 65, 59, 54, 48, 43, 38, 34, 29, 25, 22, 18, 15, 12, 10, 7, 5, 4, 2, 1, 1, 0, 0};
const short cos_ang[N] = { 32767, 32758, 32729, 32679, 32610, 32522, 32413, 32286, 32138, 31972, 31786, 31581, 31357, 31114, 30853, 30572, 30274, 29957, 29622, 29269, 28899, 28511, 28106, 27684, 27246, 26791, 26320, 25833, 25330, 24812, 24279, 23732, 23170, 22595, 22006, 21403, 20788, 20160, 19520, 18868, 18205, 17531, 16846, 16151, 15447, 14733, 14010, 13279, 12540, 11793, 11039, 10279, 9512, 8740, 7962, 7180, 6393, 5602, 4808, 4011, 3212, 2411, 1608, 804, 0, -804, -1608, -2411, -3212, -4011, -4808, -5602, -6393, -7180, -7962, -8740, -9512, -10279, -11039, -11793, -12540, -13279, -14010, -14733, -15447, -16151, -16846, -17531, -18205, -18868, -19520, -20160, -20788, -21403, -22006, -22595, -23170, -23732, -24279, -24812, -25330, -25833, -26320, -26791, -27246, -27684, -28106, -28511, -28899, -29269, -29622, -29957, -30274, -30572, -30853, -31114, -31357, -31581, -31786, -31972, -32138, -32286, -32413, -32522, -32610, -32679, -32729, -32758, -32767, -32758, -32729, -32679, -32610, -32522, -32413, -32286, -32138, -31972, -31786, -31581, -31357, -31114, -30853, -30572, -30274, -29957, -29622, -29269, -28899, -28511, -28106, -27684, -27246, -26791, -26320, -25833, -25330, -24812, -24279, -23732, -23170, -22595, -22006, -21403, -20788, -20160, -19520, -18868, -18205, -17531, -16846, -16151, -15447, -14733, -14010, -13279, -12540, -11793, -11039, -10279, -9512, -8740, -7962, -7180, -6393, -5602, -4808, -4011, -3212, -2411, -1608, -804, 0, 804, 1608, 2411, 3212, 4011, 4808, 5602, 6393, 7180, 7962, 8740, 9512, 10279, 11039, 11793, 12540, 13279, 14010, 14733, 15447, 16151, 16846, 17531, 18205, 18868, 19520, 20160, 20788, 21403, 22006, 22595, 23170, 23732, 24279, 24812, 25330, 25833, 26320, 26791, 27246, 27684, 28106, 28511, 28899, 29269, 29622, 29957, 30274, 30572, 30853, 31114, 31357, 31581, 31786, 31972, 32138, 32286, 32413, 32522, 32610, 32679, 32729, 32758};
const short sin_ang[N] = { 0, 804, 1608, 2411, 3212, 4011, 4808, 5602, 6393, 7180, 7962, 8740, 9512, 10279, 11039, 11793, 12540, 13279, 14010, 14733, 15447, 16151, 16846, 17531, 18205, 18868, 19520, 20160, 20788, 21403, 22006, 22595, 23170, 23732, 24279, 24812, 25330, 25833, 26320, 26791, 27246, 27684, 28106, 28511, 28899, 29269, 29622, 29957, 30274, 30572, 30853, 31114, 31357, 31581, 31786, 31972, 32138, 32286, 32413, 32522, 32610, 32679, 32729, 32758, 32767, 32758, 32729, 32679, 32610, 32522, 32413, 32286, 32138, 31972, 31786, 31581, 31357, 31114, 30853, 30572, 30274, 29957, 29622, 29269, 28899, 28511, 28106, 27684, 27246, 26791, 26320, 25833, 25330, 24812, 24279, 23732, 23170, 22595, 22006, 21403, 20788, 20160, 19520, 18868, 18205, 17531, 16846, 16151, 15447, 14733, 14010, 13279, 12540, 11793, 11039, 10279, 9512, 8740, 7962, 7180, 6393, 5602, 4808, 4011, 3212, 2411, 1608, 804, 0, -804, -1608, -2411, -3212, -4011, -4808, -5602, -6393, -7180, -7962, -8740, -9512, -10279, -11039, -11793, -12540, -13279, -14010, -14733, -15447, -16151, -16846, -17531, -18205, -18868, -19520, -20160, -20788, -21403, -22006, -22595, -23170, -23732, -24279, -24812, -25330, -25833, -26320, -26791, -27246, -27684, -28106, -28511, -28899, -29269, -29622, -29957, -30274, -30572, -30853, -31114, -31357, -31581, -31786, -31972, -32138, -32286, -32413, -32522, -32610, -32679, -32729, -32758, -32767, -32758, -32729, -32679, -32610, -32522, -32413, -32286, -32138, -31972, -31786, -31581, -31357, -31114, -30853, -30572, -30274, -29957, -29622, -29269, -28899, -28511, -28106, -27684, -27246, -26791, -26320, -25833, -25330, -24812, -24279, -23732, -23170, -22595, -22006, -21403, -20788, -20160, -19520, -18868, -18205, -17531, -16846, -16151, -15447, -14733, -14010, -13279, -12540, -11793, -11039, -10279, -9512, -8740, -7962, -7180, -6393, -5602, -4808, -4011, -3212, -2411, -1608, -804};
#endif

#ifdef N_512
const int hanningTab[N]={ 0, 0, 0, 0, 1, 1, 1, 2, 2, 3, 4, 5, 5, 6, 7, 8, 10, 11, 12, 14, 15, 17, 18, 20, 22, 23, 25, 27, 29, 31, 34, 36, 38, 41, 43, 46, 48, 51, 54, 56, 59, 62, 65, 68, 71, 75, 78, 81, 85, 88, 92, 95, 99, 102, 106, 110, 114, 118, 122, 126, 130, 134, 138, 143, 147, 151, 156, 160, 165, 169, 174, 179, 183, 188, 193, 198, 203, 208, 213, 218, 223, 228, 233, 239, 244, 249, 254, 260, 265, 271, 276, 282, 287, 293, 298, 304, 310, 315, 321, 327, 333, 338, 344, 350, 356, 362, 368, 374, 380, 386, 392, 398, 404, 410, 416, 422, 428, 434, 440, 446, 452, 459, 465, 471, 477, 483, 489, 495, 502, 508, 514, 520, 526, 532, 538, 545, 551, 557, 563, 569, 575, 581, 587, 593, 599, 605, 611, 617, 623, 629, 635, 641, 647, 653, 659, 664, 670, 676, 682, 687, 693, 699, 704, 710, 716, 721, 727, 732, 737, 743, 748, 754, 759, 764, 769, 774, 780, 785, 790, 795, 800, 804, 809, 814, 819, 824, 828, 833, 837, 842, 846, 851, 855, 859, 864, 868, 872, 876, 880, 884, 888, 892, 896, 899, 903, 907, 910, 914, 917, 920, 924, 927, 930, 933, 936, 939, 942, 945, 948, 950, 953, 956, 958, 961, 963, 965, 967, 970, 972, 974, 976, 977, 979, 981, 983, 984, 986, 987, 988, 990, 991, 992, 993, 994, 995, 996, 997, 997, 998, 998, 999, 999, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 999, 999, 998, 998, 997, 997, 996, 995, 994, 993, 992, 991, 990, 988, 987, 986, 984, 983, 981, 979, 977, 976, 974, 972, 970, 967, 965, 963, 961, 958, 956, 953, 950, 948, 945, 942, 939, 936, 933, 930, 927, 924, 920, 917, 914, 910, 907, 903, 899, 896, 892, 888, 884, 880, 876, 872, 868, 864, 859, 855, 851, 846, 842, 837, 833, 828, 824, 819, 814, 809, 804, 800, 795, 790, 785, 780, 774, 769, 764, 759, 754, 748, 743, 737, 732, 727, 721, 716, 710, 704, 699, 693, 687, 682, 676, 670, 664, 659, 653, 647, 641, 635, 629, 623, 617, 611, 605, 599, 593, 587, 581, 575, 569, 563, 557, 551, 545, 538, 532, 526, 520, 514, 508, 502, 495, 489, 483, 477, 471, 465, 459, 452, 446, 440, 434, 428, 422, 416, 410, 404, 398, 392, 386, 380, 374, 368, 362, 356, 350, 344, 338, 333, 327, 321, 315, 310, 304, 298, 293, 287, 282, 276, 271, 265, 260, 254, 249, 244, 239, 233, 228, 223, 218, 213, 208, 203, 198, 193, 188, 183, 179, 174, 169, 165, 160, 156, 151, 147, 143, 138, 134, 130, 126, 122, 118, 114, 110, 106, 102, 99, 95, 92, 88, 85, 81, 78, 75, 71, 68, 65, 62, 59, 56, 54, 51, 48, 46, 43, 41, 38, 36, 34, 31, 29, 27, 25, 23, 22, 20, 18, 17, 15, 14, 12, 11, 10, 8, 7, 6, 5, 5, 4, 3, 2, 2, 1, 1, 1, 0, 0, 0, 0};
const short cos_ang[N] = { 32767, 32766, 32758, 32746, 32729, 32706, 32679, 32647, 32610, 32568, 32522, 32470, 32413, 32352, 32286, 32214, 32138, 32058, 31972, 31881, 31786, 31686, 31581, 31471, 31357, 31238, 31114, 30986, 30853, 30715, 30572, 30425, 30274, 30118, 29957, 29792, 29622, 29448, 29269, 29086, 28899, 28707, 28511, 28311, 28106, 27897, 27684, 27467, 27246, 27020, 26791, 26557, 26320, 26078, 25833, 25583, 25330, 25073, 24812, 24548, 24279, 24008, 23732, 23453, 23170, 22884, 22595, 22302, 22006, 21706, 21403, 21097, 20788, 20475, 20160, 19841, 19520, 19195, 18868, 18538, 18205, 17869, 17531, 17190, 16846, 16500, 16151, 15800, 15447, 15091, 14733, 14373, 14010, 13646, 13279, 12910, 12540, 12167, 11793, 11417, 11039, 10660, 10279, 9896, 9512, 9127, 8740, 8351, 7962, 7571, 7180, 6787, 6393, 5998, 5602, 5205, 4808, 4410, 4011, 3612, 3212, 2811, 2411, 2009, 1608, 1206, 804, 402, 0, -402, -804, -1206, -1608, -2009, -2411, -2811, -3212, -3612, -4011, -4410, -4808, -5205, -5602, -5998, -6393, -6787, -7180, -7571, -7962, -8351, -8740, -9127, -9512, -9896, -10279, -10660, -11039, -11417, -11793, -12167, -12540, -12910, -13279, -13646, -14010, -14373, -14733, -15091, -15447, -15800, -16151, -16500, -16846, -17190, -17531, -17869, -18205, -18538, -18868, -19195, -19520, -19841, -20160, -20475, -20788, -21097, -21403, -21706, -22006, -22302, -22595, -22884, -23170, -23453, -23732, -24008, -24279, -24548, -24812, -25073, -25330, -25583, -25833, -26078, -26320, -26557, -26791, -27020, -27246, -27467, -27684, -27897, -28106, -28311, -28511, -28707, -28899, -29086, -29269, -29448, -29622, -29792, -29957, -30118, -30274, -30425, -30572, -30715, -30853, -30986, -31114, -31238, -31357, -31471, -31581, -31686, -31786, -31881, -31972, -32058, -32138, -32214, -32286, -32352, -32413, -32470, -32522, -32568, -32610, -32647, -32679, -32706, -32729, -32746, -32758, -32766, -32767, -32766, -32758, -32746, -32729, -32706, -32679, -32647, -32610, -32568, -32522, -32470, -32413, -32352, -32286, -32214, -32138, -32058, -31972, -31881, -31786, -31686, -31581, -31471, -31357, -31238, -31114, -30986, -30853, -30715, -30572, -30425, -30274, -30118, -29957, -29792, -29622, -29448, -29269, -29086, -28899, -28707, -28511, -28311, -28106, -27897, -27684, -27467, -27246, -27020, -26791, -26557, -26320, -26078, -25833, -25583, -25330, -25073, -24812, -24548, -24279, -24008, -23732, -23453, -23170, -22884, -22595, -22302, -22006, -21706, -21403, -21097, -20788, -20475, -20160, -19841, -19520, -19195, -18868, -18538, -18205, -17869, -17531, -17190, -16846, -16500, -16151, -15800, -15447, -15091, -14733, -14373, -14010, -13646, -13279, -12910, -12540, -12167, -11793, -11417, -11039, -10660, -10279, -9896, -9512, -9127, -8740, -8351, -7962, -7571, -7180, -6787, -6393, -5998, -5602, -5205, -4808, -4410, -4011, -3612, -3212, -2811, -2411, -2009, -1608, -1206, -804, -402, 0, 402, 804, 1206, 1608, 2009, 2411, 2811, 3212, 3612, 4011, 4410, 4808, 5205, 5602, 5998, 6393, 6787, 7180, 7571, 7962, 8351, 8740, 9127, 9512, 9896, 10279, 10660, 11039, 11417, 11793, 12167, 12540, 12910, 13279, 13646, 14010, 14373, 14733, 15091, 15447, 15800, 16151, 16500, 16846, 17190, 17531, 17869, 18205, 18538, 18868, 19195, 19520, 19841, 20160, 20475, 20788, 21097, 21403, 21706, 22006, 22302, 22595, 22884, 23170, 23453, 23732, 24008, 24279, 24548, 24812, 25073, 25330, 25583, 25833, 26078, 26320, 26557, 26791, 27020, 27246, 27467, 27684, 27897, 28106, 28311, 28511, 28707, 28899, 29086, 29269, 29448, 29622, 29792, 29957, 30118, 30274, 30425, 30572, 30715, 30853, 30986, 31114, 31238, 31357, 31471, 31581, 31686, 31786, 31881, 31972, 32058, 32138, 32214, 32286, 32352, 32413, 32470, 32522, 32568, 32610, 32647, 32679, 32706, 32729, 32746, 32758, 32765};
const short sin_ang[N] = { 0, 402, 804, 1206, 1608, 2009, 2411, 2811, 3212, 3612, 4011, 4410, 4808, 5205, 5602, 5998, 6393, 6787, 7180, 7571, 7962, 8351, 8740, 9127, 9512, 9896, 10279, 10660, 11039, 11417, 11793, 12167, 12540, 12910, 13279, 13646, 14010, 14373, 14733, 15091, 15447, 15800, 16151, 16500, 16846, 17190, 17531, 17869, 18205, 18538, 18868, 19195, 19520, 19841, 20160, 20475, 20788, 21097, 21403, 21706, 22006, 22302, 22595, 22884, 23170, 23453, 23732, 24008, 24279, 24548, 24812, 25073, 25330, 25583, 25833, 26078, 26320, 26557, 26791, 27020, 27246, 27467, 27684, 27897, 28106, 28311, 28511, 28707, 28899, 29086, 29269, 29448, 29622, 29792, 29957, 30118, 30274, 30425, 30572, 30715, 30853, 30986, 31114, 31238, 31357, 31471, 31581, 31686, 31786, 31881, 31972, 32058, 32138, 32214, 32286, 32352, 32413, 32470, 32522, 32568, 32610, 32647, 32679, 32706, 32729, 32746, 32758, 32766, 32767, 32766, 32758, 32746, 32729, 32706, 32679, 32647, 32610, 32568, 32522, 32470, 32413, 32352, 32286, 32214, 32138, 32058, 31972, 31881, 31786, 31686, 31581, 31471, 31357, 31238, 31114, 30986, 30853, 30715, 30572, 30425, 30274, 30118, 29957, 29792, 29622, 29448, 29269, 29086, 28899, 28707, 28511, 28311, 28106, 27897, 27684, 27467, 27246, 27020, 26791, 26557, 26320, 26078, 25833, 25583, 25330, 25073, 24812, 24548, 24279, 24008, 23732, 23453, 23170, 22884, 22595, 22302, 22006, 21706, 21403, 21097, 20788, 20475, 20160, 19841, 19520, 19195, 18868, 18538, 18205, 17869, 17531, 17190, 16846, 16500, 16151, 15800, 15447, 15091, 14733, 14373, 14010, 13646, 13279, 12910, 12540, 12167, 11793, 11417, 11039, 10660, 10279, 9896, 9512, 9127, 8740, 8351, 7962, 7571, 7180, 6787, 6393, 5998, 5602, 5205, 4808, 4410, 4011, 3612, 3212, 2811, 2411, 2009, 1608, 1206, 804, 402, 0, -402, -804, -1206, -1608, -2009, -2411, -2811, -3212, -3612, -4011, -4410, -4808, -5205, -5602, -5998, -6393, -6787, -7180, -7571, -7962, -8351, -8740, -9127, -9512, -9896, -10279, -10660, -11039, -11417, -11793, -12167, -12540, -12910, -13279, -13646, -14010, -14373, -14733, -15091, -15447, -15800, -16151, -16500, -16846, -17190, -17531, -17869, -18205, -18538, -18868, -19195, -19520, -19841, -20160, -20475, -20788, -21097, -21403, -21706, -22006, -22302, -22595, -22884, -23170, -23453, -23732, -24008, -24279, -24548, -24812, -25073, -25330, -25583, -25833, -26078, -26320, -26557, -26791, -27020, -27246, -27467, -27684, -27897, -28106, -28311, -28511, -28707, -28899, -29086, -29269, -29448, -29622, -29792, -29957, -30118, -30274, -30425, -30572, -30715, -30853, -30986, -31114, -31238, -31357, -31471, -31581, -31686, -31786, -31881, -31972, -32058, -32138, -32214, -32286, -32352, -32413, -32470, -32522, -32568, -32610, -32647, -32679, -32706, -32729, -32746, -32758, -32766, -32767, -32766, -32758, -32746, -32729, -32706, -32679, -32647, -32610, -32568, -32522, -32470, -32413, -32352, -32286, -32214, -32138, -32058, -31972, -31881, -31786, -31686, -31581, -31471, -31357, -31238, -31114, -30986, -30853, -30715, -30572, -30425, -30274, -30118, -29957, -29792, -29622, -29448, -29269, -29086, -28899, -28707, -28511, -28311, -28106, -27897, -27684, -27467, -27246, -27020, -26791, -26557, -26320, -26078, -25833, -25583, -25330, -25073, -24812, -24548, -24279, -24008, -23732, -23453, -23170, -22884, -22595, -22302, -22006, -21706, -21403, -21097, -20788, -20475, -20160, -19841, -19520, -19195, -18868, -18538, -18205, -17869, -17531, -17190, -16846, -16500, -16151, -15800, -15447, -15091, -14733, -14373, -14010, -13646, -13279, -12910, -12540, -12167, -11793, -11417, -11039, -10660, -10279, -9896, -9512, -9127, -8740, -8351, -7962, -7571, -7180, -6787, -6393, -5998, -5602, -5205, -4808, -4410, -4011, -3612, -3212, -2811, -2411, -2009, -1608, -1206, -804, -402};
#endif

#ifdef N_128
const int hanningTab[N]={ 0, 1, 2, 5, 10, 15, 22, 30, 39, 49, 60, 72, 86, 100, 115, 131, 149, 167, 186, 205, 225, 246, 268, 290, 313, 336, 360, 384, 408, 432, 457, 481, 506, 531, 556, 580, 604, 628, 652, 676, 698, 721, 743, 764, 785, 805, 824, 842, 860, 877, 893, 907, 921, 934, 946, 956, 966, 974, 982, 988, 993, 996, 999, 1000, 1000, 999, 996, 993, 988, 982, 974, 966, 956, 946, 934, 921, 907, 893, 877, 860, 842, 824, 805, 785, 764, 743, 721, 698, 676, 652, 628, 604, 580, 556, 531, 506, 481, 457, 432, 408, 384, 360, 336, 313, 290, 268, 246, 225, 205, 186, 167, 149, 131, 115, 100, 86, 72, 60, 49, 39, 30, 22, 15, 10, 5, 2, 1, 0};
const short cos_ang[N] = { 32767, 32729, 32610, 32413, 32138, 31786, 31357, 30853, 30274, 29622, 28899, 28106, 27246, 26320, 25330, 24279, 23170, 22006, 20788, 19520, 18205, 16846, 15447, 14010, 12540, 11039, 9512, 7962, 6393, 4808, 3212, 1608, 0, -1608, -3212, -4808, -6393, -7962, -9512, -11039, -12540, -14010, -15447, -16846, -18205, -19520, -20788, -22006, -23170, -24279, -25330, -26320, -27246, -28106, -28899, -29622, -30274, -30853, -31357, -31786, -32138, -32413, -32610, -32729, -32767, -32729, -32610, -32413, -32138, -31786, -31357, -30853, -30274, -29622, -28899, -28106, -27246, -26320, -25330, -24279, -23170, -22006, -20788, -19520, -18205, -16846, -15447, -14010, -12540, -11039, -9512, -7962, -6393, -4808, -3212, -1608, 0, 1608, 3212, 4808, 6393, 7962, 9512, 11039, 12540, 14010, 15447, 16846, 18205, 19520, 20788, 22006, 23170, 24279, 25330, 26320, 27246, 28106, 28899, 29622, 30274, 30853, 31357, 31786, 32138, 32413, 32610, 32728};
const short sin_ang[N] = { 0, 1608, 3212, 4808, 6393, 7962, 9512, 11039, 12540, 14010, 15447, 16846, 18205, 19520, 20788, 22006, 23170, 24279, 25330, 26320, 27246, 28106, 28899, 29622, 30274, 30853, 31357, 31786, 32138, 32413, 32610, 32729, 32767, 32729, 32610, 32413, 32138, 31786, 31357, 30853, 30274, 29622, 28899, 28106, 27246, 26320, 25330, 24279, 23170, 22006, 20788, 19520, 18205, 16846, 15447, 14010, 12540, 11039, 9512, 7962, 6393, 4808, 3212, 1608, 0, -1608, -3212, -4808, -6393, -7962, -9512, -11039, -12540, -14010, -15447, -16846, -18205, -19520, -20788, -22006, -23170, -24279, -25330, -26320, -27246, -28106, -28899, -29622, -30274, -30853, -31357, -31786, -32138, -32413, -32610, -32729, -32767, -32729, -32610, -32413, -32138, -31786, -31357, -30853, -30274, -29622, -28899, -28106, -27246, -26320, -25330, -24279, -23170, -22006, -20788, -19520, -18205, -16846, -15447, -14010, -12540, -11039, -9512, -7962, -6393, -4808, -3212, -1607};
#endif

#ifdef N_64
const int hanningTab[N]={ 0, 2, 10, 22, 39, 61, 87, 117, 151, 188, 229, 272, 317, 365, 413, 463, 512, 562, 611, 659, 706, 750, 792, 831, 867, 899, 927, 950, 970, 985, 994, 999, 999, 994, 985, 970, 950, 927, 899, 867, 831, 792, 750, 706, 659, 611, 562, 512, 463, 413, 365, 317, 272, 229, 188, 151, 117, 87, 61, 39, 22, 10, 2, 0};
const short cos_ang[N] = { 32767, 32610, 32138, 31357, 30274, 28899, 27246, 25330, 23170, 20788, 18205, 15447, 12540, 9512, 6393, 3212, 0, -3212, -6393, -9512, -12540, -15447, -18205, -20788, -23170, -25330, -27246, -28899, -30274, -31357, -32138, -32610, -32767, -32610, -32138, -31357, -30274, -28899, -27246, -25330, -23170, -20788, -18205, -15447, -12540, -9512, -6393, -3212, 0, 3212, 6393, 9512, 12540, 15447, 18205, 20788, 23170, 25330, 27246, 28899, 30274, 31357, 32138, 32610};
const short sin_ang[N] = { 0, 3212, 6393, 9512, 12540, 15447, 18205, 20788, 23170, 25330, 27246, 28899, 30274, 31357, 32138, 32610, 32767, 32610, 32138, 31357, 30274, 28899, 27246, 25330, 23170, 20788, 18205, 15447, 12540, 9512, 6393, 3212, 0, -3212, -6393, -9512, -12540, -15447, -18205, -20788, -23170, -25330, -27246, -28899, -30274, -31357, -32138, -32610, -32767, -32610, -32138, -31357, -30274, -28899, -27246, -25330, -23170, -20788, -18205, -15447, -12540, -9512, -6393, -3211};
#endif


static int bit_reverse_fixed(int *buf_rvs,int size)
{
    int r = 0;              // counter
    int s = 0;              // bit-reversal of r/2
    int N2 = size << 1;     // N<<1 == N*2
    int i = 0;

    do {
        buf_rvs[i++] = s; 
        r += 2;
        s ^= size - (size / (r&-r));
    }
    while (r < N2);
    return s;
}

/*
    decimation-in-freq radix-2 in-place butterfly
    data:   (array of int , order below)
    re(0),im(0),re(1),im(1),...,re(size-1),im(size-1)
    means size=array_length/2 !!

    useage:
    intput in normal order
    output in bit-reversed order
*/
static void dif_butterfly_fixed(int *data, long size)
{

    long  angle, astep, dl;
    int   xr, yr, xi, yi, dr, di;
    short wr, wi;
    int   *l1, *l2, *end, *ol2;


    astep = 1;
    end   = data + size + size;
    for (dl = size; dl > 1; dl >>= 1, astep += astep) {
        l1 = data;
        l2 = data + dl;
        for (; l2 < end; l1 = l2, l2 = l2 + dl) {
            ol2 = l2;
            for (angle = 0; l1 < ol2; l1 += 2, l2 += 2) {
                wr = cos_ang[angle];
                wi = -sin_ang[angle];

                xr = *l1     + *l2;
                xi = *(l1+1) + *(l2+1);
                dr = *l1     - *l2;
                di = *(l1+1) - *(l2+1);

                yr = FA_FIXMUL_32X15(dr, wr) - FA_FIXMUL_32X15(di, wi);
                yi = FA_FIXMUL_32X15(dr, wi) + FA_FIXMUL_32X15(di, wr);

                *(l1) = xr; *(l1 + 1) = xi;
                *(l2) = yr; *(l2 + 1) = yi;
                angle += astep;
            }
        }
    }
}


/*
    decimation-in-time radix-2 in-place inverse butterfly
    data:   (array of float, below order)
    re(0),im(0),re(1),im(1),...,re(size-1),im(size-1)
    means size=array_length/2 

    useage:
    intput in bit-reversed order
    output in normal order
*/
static void inverse_dit_butterfly_fixed(int *data, long size)
{

    long  angle, astep, dl;
    int   xr, yr, xi, yi, dr, di;
    short wr, wi;
    int   *l1, *l2, *end, *ol2;

    astep = size >> 1;
    end   = data + size + size;
    for (dl = 2; astep > 0; dl += dl, astep >>= 1) {
        l1 = data;
        l2 = data + dl;
        for (;l2 < end; l1 = l2, l2 = l2 + dl) {
            ol2 = l2;
            for (angle = 0; l1 < ol2; l1 += 2, l2 += 2) {
                wr = cos_ang[angle];
                wi = sin_ang[angle];
                xr = *l1;
                xi = *(l1 + 1);
                yr = *l2;
                yi = *(l2 + 1);

                dr = FA_FIXMUL_32X15(yr, wr) - FA_FIXMUL_32X15(yi, wi);
                di = FA_FIXMUL_32X15(yr, wi) + FA_FIXMUL_32X15(yi, wr);

                *(l1) = xr + dr; *(l1 + 1) = xi + di;
                *(l2) = xr - dr; *(l2 + 1) = xi - di;
                angle += astep;
            }
        }
    }
}



/*
    in-place Radix-2 FFT for complex values
    data:   (array of int, below order)
    re(0),im(0),re(1),im(1),...,re(size-1),im(size-1)
    means size=array_length/2 !!

    output is in similar order, normalized by array length
*/
static void fa_fft_fixed(int *data)
{
    int i,bit;
    dif_butterfly_fixed(data,N);
    for (i = 0 ; i < N ; i++) {
        bit = bit_rvs[i];
        fft_work[i+i] = data[bit+bit]; fft_work[i+i+1] = data[bit+bit+1];
    }
    for (i = 0; i < N ; i++) {
        data[i+i] = fft_work[i+i];
        data[i+i+1] = fft_work[i+i+1];
    }
}


/*
    in-place Radix-2 inverse FFT for complex values
    data:   (array of int, below order)
    re(0),im(0),re(1),im(1),...,re(size-1),im(size-1)
    means size=array_length/2 !!

    output is in similar order, NOT normalized by array length
*/
#if 0
static void fa_ifft_fixed(int * data)
{
    int i,bit;
 
    for (i = 0 ; i < N ; i++) {
        bit = bit_rvs[i];
        fft_work[i+i] = data[bit+bit]; fft_work[i+i+1] = data[bit+bit+1];
    }

    for (i = 0; i < N ; i++) {
        data[i+i] = fft_work[i+i];
        data[i+i+1] = fft_work[i+i+1];
    }

    inverse_dit_butterfly_fixed(data,N,cos_ang,sin_ang);

    for (i = 0; i < N ; i++) {
        data[i+i] = data[i+i] >> base;
        data[i+i+1] = data[i+i+1] >> base;
    }
}


#endif
void zfft_init()
{
    int i;
    float ang;
    //float ang;
    //base = (int)(log(N)/log(2));
    //if ((1<<base) < N)
    //    base += 1;
    bit_reverse_fixed(bit_rvs,N);
 	  /*for (i = 0 ; i < N ; i++) {
        ang = (2*M_PI*i)/N;
        //cos_ang[i] = FA_FIX15(cos(ang));
        sin_ang[i] = FA_FIX15(sin(ang));
        printf("%d, ",sin_ang[i]);
    }
    printf("\n");
    for (i = 0 ; i < N ; i++) {
        ang = (2*M_PI*i)/N;
        cos_ang[i] = FA_FIX15(cos(ang));
        //sin_ang[i] = FA_FIX15(sin(ang));
        printf("%d, ",cos_ang[i]);
    }
    printf("\n");*/
}



static int ourMem[N*2];
void zfft(int *data)
{
    int i,val;
    for(i=0;i<N;i++){
        ourMem[i*2] = data[i]*hanningTab[i]/1000;
        //printf("data%d = %d\n",i,ourMem[i*2]);
        ourMem[i*2+1] = 0;
    }
    fa_fft_fixed(ourMem);
    for(i=0;i<N;i++){
        ourMem[2*i]/=DIV_ME;//al
        ourMem[2*i+1]/=DIV_ME;
        val = ourMem[2*i]*ourMem[2*i] + ourMem[2*i+1]*ourMem[2*i+1];
        data[i] = val/DIV_ME;
        //ata1000
        //printf("i=%d %d %d %d\n",i,ourMem[2*i],ourMem[2*i+1],val);
    }
}


